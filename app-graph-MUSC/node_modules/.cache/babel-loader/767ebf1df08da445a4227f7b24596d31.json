{"ast":null,"code":"\"use strict\";\n/**\n * Copyright (c) \"Neo4j\"\n * Neo4j Sweden AB [http://neo4j.com]\n *\n * This file is part of Neo4j.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar neo4j_driver_core_1 = require(\"neo4j-driver-core\");\n\nvar _a = neo4j_driver_core_1.internal.constants,\n    ACCESS_MODE_READ = _a.ACCESS_MODE_READ,\n    FETCH_ALL = _a.FETCH_ALL,\n    assertString = neo4j_driver_core_1.internal.util.assertString;\n/* eslint-disable no-unused-vars */\n// Signature bytes for each request message type\n\nvar INIT = 0x01; // 0000 0001 // INIT <user_agent> <authentication_token>\n\nvar ACK_FAILURE = 0x0e; // 0000 1110 // ACK_FAILURE - unused\n\nvar RESET = 0x0f; // 0000 1111 // RESET\n\nvar RUN = 0x10; // 0001 0000 // RUN <query> <parameters>\n\nvar DISCARD_ALL = 0x2f; // 0010 1111 // DISCARD_ALL - unused\n\nvar PULL_ALL = 0x3f; // 0011 1111 // PULL_ALL\n\nvar HELLO = 0x01; // 0000 0001 // HELLO <metadata>\n\nvar GOODBYE = 0x02; // 0000 0010 // GOODBYE\n\nvar BEGIN = 0x11; // 0001 0001 // BEGIN <metadata>\n\nvar COMMIT = 0x12; // 0001 0010 // COMMIT\n\nvar ROLLBACK = 0x13; // 0001 0011 // ROLLBACK\n\nvar ROUTE = 0x66; // 0110 0110 // ROUTE\n\nvar DISCARD = 0x2f; // 0010 1111 // DISCARD\n\nvar PULL = 0x3f; // 0011 1111 // PULL\n\nvar READ_MODE = 'r';\n/* eslint-enable no-unused-vars */\n\nvar NO_STATEMENT_ID = -1;\n\nvar RequestMessage =\n/** @class */\nfunction () {\n  function RequestMessage(signature, fields, toString) {\n    this.signature = signature;\n    this.fields = fields;\n    this.toString = toString;\n  }\n  /**\n   * Create a new INIT message.\n   * @param {string} clientName the client name.\n   * @param {Object} authToken the authentication token.\n   * @return {RequestMessage} new INIT message.\n   */\n\n\n  RequestMessage.init = function (clientName, authToken) {\n    return new RequestMessage(INIT, [clientName, authToken], function () {\n      return \"INIT \" + clientName + \" {...}\";\n    });\n  };\n  /**\n   * Create a new RUN message.\n   * @param {string} query the cypher query.\n   * @param {Object} parameters the query parameters.\n   * @return {RequestMessage} new RUN message.\n   */\n\n\n  RequestMessage.run = function (query, parameters) {\n    return new RequestMessage(RUN, [query, parameters], function () {\n      return \"RUN \" + query + \" \" + neo4j_driver_core_1.json.stringify(parameters);\n    });\n  };\n  /**\n   * Get a PULL_ALL message.\n   * @return {RequestMessage} the PULL_ALL message.\n   */\n\n\n  RequestMessage.pullAll = function () {\n    return PULL_ALL_MESSAGE;\n  };\n  /**\n   * Get a RESET message.\n   * @return {RequestMessage} the RESET message.\n   */\n\n\n  RequestMessage.reset = function () {\n    return RESET_MESSAGE;\n  };\n  /**\n   * Create a new HELLO message.\n   * @param {string} userAgent the user agent.\n   * @param {Object} authToken the authentication token.\n   * @param {Object} optional server side routing, set to routing context to turn on server side routing (> 4.1)\n   * @return {RequestMessage} new HELLO message.\n   */\n\n\n  RequestMessage.hello = function (userAgent, authToken, routing) {\n    if (routing === void 0) {\n      routing = null;\n    }\n\n    var metadata = Object.assign({\n      user_agent: userAgent\n    }, authToken);\n\n    if (routing) {\n      metadata.routing = routing;\n    }\n\n    return new RequestMessage(HELLO, [metadata], function () {\n      return \"HELLO {user_agent: '\" + userAgent + \"', ...}\";\n    });\n  };\n  /**\n   * Create a new BEGIN message.\n   * @param {Bookmark} bookmark the bookmark.\n   * @param {TxConfig} txConfig the configuration.\n   * @param {string} database the database name.\n   * @param {string} mode the access mode.\n   * @param {string} impersonatedUser the impersonated user.\n   * @return {RequestMessage} new BEGIN message.\n   */\n\n\n  RequestMessage.begin = function (_a) {\n    var _b = _a === void 0 ? {} : _a,\n        bookmark = _b.bookmark,\n        txConfig = _b.txConfig,\n        database = _b.database,\n        mode = _b.mode,\n        impersonatedUser = _b.impersonatedUser;\n\n    var metadata = buildTxMetadata(bookmark, txConfig, database, mode, impersonatedUser);\n    return new RequestMessage(BEGIN, [metadata], function () {\n      return \"BEGIN \" + neo4j_driver_core_1.json.stringify(metadata);\n    });\n  };\n  /**\n   * Get a COMMIT message.\n   * @return {RequestMessage} the COMMIT message.\n   */\n\n\n  RequestMessage.commit = function () {\n    return COMMIT_MESSAGE;\n  };\n  /**\n   * Get a ROLLBACK message.\n   * @return {RequestMessage} the ROLLBACK message.\n   */\n\n\n  RequestMessage.rollback = function () {\n    return ROLLBACK_MESSAGE;\n  };\n  /**\n   * Create a new RUN message with additional metadata.\n   * @param {string} query the cypher query.\n   * @param {Object} parameters the query parameters.\n   * @param {Bookmark} bookmark the bookmark.\n   * @param {TxConfig} txConfig the configuration.\n   * @param {string} database the database name.\n   * @param {string} mode the access mode.\n   * @param {string} impersonatedUser the impersonated user.\n   * @return {RequestMessage} new RUN message with additional metadata.\n   */\n\n\n  RequestMessage.runWithMetadata = function (query, parameters, _a) {\n    var _b = _a === void 0 ? {} : _a,\n        bookmark = _b.bookmark,\n        txConfig = _b.txConfig,\n        database = _b.database,\n        mode = _b.mode,\n        impersonatedUser = _b.impersonatedUser;\n\n    var metadata = buildTxMetadata(bookmark, txConfig, database, mode, impersonatedUser);\n    return new RequestMessage(RUN, [query, parameters, metadata], function () {\n      return \"RUN \" + query + \" \" + neo4j_driver_core_1.json.stringify(parameters) + \" \" + neo4j_driver_core_1.json.stringify(metadata);\n    });\n  };\n  /**\n   * Get a GOODBYE message.\n   * @return {RequestMessage} the GOODBYE message.\n   */\n\n\n  RequestMessage.goodbye = function () {\n    return GOODBYE_MESSAGE;\n  };\n  /**\n   * Generates a new PULL message with additional metadata.\n   * @param {Integer|number} stmtId\n   * @param {Integer|number} n\n   * @return {RequestMessage} the PULL message.\n   */\n\n\n  RequestMessage.pull = function (_a) {\n    var _b = _a === void 0 ? {} : _a,\n        _c = _b.stmtId,\n        stmtId = _c === void 0 ? NO_STATEMENT_ID : _c,\n        _d = _b.n,\n        n = _d === void 0 ? FETCH_ALL : _d;\n\n    var metadata = buildStreamMetadata(stmtId === null || stmtId === undefined ? NO_STATEMENT_ID : stmtId, n || FETCH_ALL);\n    return new RequestMessage(PULL, [metadata], function () {\n      return \"PULL \" + neo4j_driver_core_1.json.stringify(metadata);\n    });\n  };\n  /**\n   * Generates a new DISCARD message with additional metadata.\n   * @param {Integer|number} stmtId\n   * @param {Integer|number} n\n   * @return {RequestMessage} the PULL message.\n   */\n\n\n  RequestMessage.discard = function (_a) {\n    var _b = _a === void 0 ? {} : _a,\n        _c = _b.stmtId,\n        stmtId = _c === void 0 ? NO_STATEMENT_ID : _c,\n        _d = _b.n,\n        n = _d === void 0 ? FETCH_ALL : _d;\n\n    var metadata = buildStreamMetadata(stmtId === null || stmtId === undefined ? NO_STATEMENT_ID : stmtId, n || FETCH_ALL);\n    return new RequestMessage(DISCARD, [metadata], function () {\n      return \"DISCARD \" + neo4j_driver_core_1.json.stringify(metadata);\n    });\n  };\n  /**\n   * Generate the ROUTE message, this message is used to fetch the routing table from the server\n   *\n   * @param {object} routingContext The routing context used to define the routing table. Multi-datacenter deployments is one of its use cases\n   * @param {string[]} bookmarks The list of the bookmark should be used\n   * @param {string} databaseName The name of the database to get the routing table for.\n   * @return {RequestMessage} the ROUTE message.\n   */\n\n\n  RequestMessage.route = function (routingContext, bookmarks, databaseName) {\n    if (routingContext === void 0) {\n      routingContext = {};\n    }\n\n    if (bookmarks === void 0) {\n      bookmarks = [];\n    }\n\n    if (databaseName === void 0) {\n      databaseName = null;\n    }\n\n    return new RequestMessage(ROUTE, [routingContext, bookmarks, databaseName], function () {\n      return \"ROUTE \" + neo4j_driver_core_1.json.stringify(routingContext) + \" \" + neo4j_driver_core_1.json.stringify(bookmarks) + \" \" + databaseName;\n    });\n  };\n  /**\n   * Generate the ROUTE message, this message is used to fetch the routing table from the server\n   *\n   * @param {object} routingContext The routing context used to define the routing table. Multi-datacenter deployments is one of its use cases\n   * @param {string[]} bookmarks The list of the bookmark should be used\n   * @param {object} databaseContext The context inforamtion of the database to get the routing table for.\n   * @param {string} databaseContext.databaseName The name of the database to get the routing table.\n   * @param {string} databaseContext.impersonatedUser The name of the user to impersonation when getting the routing table.\n   * @return {RequestMessage} the ROUTE message.\n   */\n\n\n  RequestMessage.routeV4x4 = function (routingContext, bookmarks, databaseContext) {\n    if (routingContext === void 0) {\n      routingContext = {};\n    }\n\n    if (bookmarks === void 0) {\n      bookmarks = [];\n    }\n\n    if (databaseContext === void 0) {\n      databaseContext = {};\n    }\n\n    var dbContext = {};\n\n    if (databaseContext.databaseName) {\n      dbContext.db = databaseContext.databaseName;\n    }\n\n    if (databaseContext.impersonatedUser) {\n      dbContext.imp_user = databaseContext.impersonatedUser;\n    }\n\n    return new RequestMessage(ROUTE, [routingContext, bookmarks, dbContext], function () {\n      return \"ROUTE \" + neo4j_driver_core_1.json.stringify(routingContext) + \" \" + neo4j_driver_core_1.json.stringify(bookmarks) + \" \" + neo4j_driver_core_1.json.stringify(dbContext);\n    });\n  };\n\n  return RequestMessage;\n}();\n\nexports.default = RequestMessage;\n/**\n * Create an object that represent transaction metadata.\n * @param {Bookmark} bookmark the bookmark.\n * @param {TxConfig} txConfig the configuration.\n * @param {string} database the database name.\n * @param {string} mode the access mode.\n * @param {string} impersonatedUser the impersonated user mode.\n * @return {Object} a metadata object.\n */\n\nfunction buildTxMetadata(bookmark, txConfig, database, mode, impersonatedUser) {\n  var metadata = {};\n\n  if (!bookmark.isEmpty()) {\n    metadata.bookmarks = bookmark.values();\n  }\n\n  if (txConfig.timeout) {\n    metadata.tx_timeout = txConfig.timeout;\n  }\n\n  if (txConfig.metadata) {\n    metadata.tx_metadata = txConfig.metadata;\n  }\n\n  if (database) {\n    metadata.db = assertString(database, 'database');\n  }\n\n  if (impersonatedUser) {\n    metadata.imp_user = assertString(impersonatedUser, 'impersonatedUser');\n  }\n\n  if (mode === ACCESS_MODE_READ) {\n    metadata.mode = READ_MODE;\n  }\n\n  return metadata;\n}\n/**\n * Create an object that represents streaming metadata.\n * @param {Integer|number} stmtId The query id to stream its results.\n * @param {Integer|number} n The number of records to stream.\n * @returns {Object} a metadata object.\n */\n\n\nfunction buildStreamMetadata(stmtId, n) {\n  var metadata = {\n    n: (0, neo4j_driver_core_1.int)(n)\n  };\n\n  if (stmtId !== NO_STATEMENT_ID) {\n    metadata.qid = (0, neo4j_driver_core_1.int)(stmtId);\n  }\n\n  return metadata;\n} // constants for messages that never change\n\n\nvar PULL_ALL_MESSAGE = new RequestMessage(PULL_ALL, [], function () {\n  return 'PULL_ALL';\n});\nvar RESET_MESSAGE = new RequestMessage(RESET, [], function () {\n  return 'RESET';\n});\nvar COMMIT_MESSAGE = new RequestMessage(COMMIT, [], function () {\n  return 'COMMIT';\n});\nvar ROLLBACK_MESSAGE = new RequestMessage(ROLLBACK, [], function () {\n  return 'ROLLBACK';\n});\nvar GOODBYE_MESSAGE = new RequestMessage(GOODBYE, [], function () {\n  return 'GOODBYE';\n});","map":{"version":3,"names":["Object","defineProperty","exports","value","neo4j_driver_core_1","require","_a","internal","constants","ACCESS_MODE_READ","FETCH_ALL","assertString","util","INIT","ACK_FAILURE","RESET","RUN","DISCARD_ALL","PULL_ALL","HELLO","GOODBYE","BEGIN","COMMIT","ROLLBACK","ROUTE","DISCARD","PULL","READ_MODE","NO_STATEMENT_ID","RequestMessage","signature","fields","toString","init","clientName","authToken","run","query","parameters","json","stringify","pullAll","PULL_ALL_MESSAGE","reset","RESET_MESSAGE","hello","userAgent","routing","metadata","assign","user_agent","begin","_b","bookmark","txConfig","database","mode","impersonatedUser","buildTxMetadata","commit","COMMIT_MESSAGE","rollback","ROLLBACK_MESSAGE","runWithMetadata","goodbye","GOODBYE_MESSAGE","pull","_c","stmtId","_d","n","buildStreamMetadata","undefined","discard","route","routingContext","bookmarks","databaseName","routeV4x4","databaseContext","dbContext","db","imp_user","default","isEmpty","values","timeout","tx_timeout","tx_metadata","int","qid"],"sources":["/Users/zack/src/gene-graph-MUSC/node_modules/neo4j-driver-bolt-connection/lib/bolt/request-message.js"],"sourcesContent":["\"use strict\";\n/**\n * Copyright (c) \"Neo4j\"\n * Neo4j Sweden AB [http://neo4j.com]\n *\n * This file is part of Neo4j.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar neo4j_driver_core_1 = require(\"neo4j-driver-core\");\nvar _a = neo4j_driver_core_1.internal.constants, ACCESS_MODE_READ = _a.ACCESS_MODE_READ, FETCH_ALL = _a.FETCH_ALL, assertString = neo4j_driver_core_1.internal.util.assertString;\n/* eslint-disable no-unused-vars */\n// Signature bytes for each request message type\nvar INIT = 0x01; // 0000 0001 // INIT <user_agent> <authentication_token>\nvar ACK_FAILURE = 0x0e; // 0000 1110 // ACK_FAILURE - unused\nvar RESET = 0x0f; // 0000 1111 // RESET\nvar RUN = 0x10; // 0001 0000 // RUN <query> <parameters>\nvar DISCARD_ALL = 0x2f; // 0010 1111 // DISCARD_ALL - unused\nvar PULL_ALL = 0x3f; // 0011 1111 // PULL_ALL\nvar HELLO = 0x01; // 0000 0001 // HELLO <metadata>\nvar GOODBYE = 0x02; // 0000 0010 // GOODBYE\nvar BEGIN = 0x11; // 0001 0001 // BEGIN <metadata>\nvar COMMIT = 0x12; // 0001 0010 // COMMIT\nvar ROLLBACK = 0x13; // 0001 0011 // ROLLBACK\nvar ROUTE = 0x66; // 0110 0110 // ROUTE\nvar DISCARD = 0x2f; // 0010 1111 // DISCARD\nvar PULL = 0x3f; // 0011 1111 // PULL\nvar READ_MODE = 'r';\n/* eslint-enable no-unused-vars */\nvar NO_STATEMENT_ID = -1;\nvar RequestMessage = /** @class */ (function () {\n    function RequestMessage(signature, fields, toString) {\n        this.signature = signature;\n        this.fields = fields;\n        this.toString = toString;\n    }\n    /**\n     * Create a new INIT message.\n     * @param {string} clientName the client name.\n     * @param {Object} authToken the authentication token.\n     * @return {RequestMessage} new INIT message.\n     */\n    RequestMessage.init = function (clientName, authToken) {\n        return new RequestMessage(INIT, [clientName, authToken], function () { return \"INIT \" + clientName + \" {...}\"; });\n    };\n    /**\n     * Create a new RUN message.\n     * @param {string} query the cypher query.\n     * @param {Object} parameters the query parameters.\n     * @return {RequestMessage} new RUN message.\n     */\n    RequestMessage.run = function (query, parameters) {\n        return new RequestMessage(RUN, [query, parameters], function () { return \"RUN \" + query + \" \" + neo4j_driver_core_1.json.stringify(parameters); });\n    };\n    /**\n     * Get a PULL_ALL message.\n     * @return {RequestMessage} the PULL_ALL message.\n     */\n    RequestMessage.pullAll = function () {\n        return PULL_ALL_MESSAGE;\n    };\n    /**\n     * Get a RESET message.\n     * @return {RequestMessage} the RESET message.\n     */\n    RequestMessage.reset = function () {\n        return RESET_MESSAGE;\n    };\n    /**\n     * Create a new HELLO message.\n     * @param {string} userAgent the user agent.\n     * @param {Object} authToken the authentication token.\n     * @param {Object} optional server side routing, set to routing context to turn on server side routing (> 4.1)\n     * @return {RequestMessage} new HELLO message.\n     */\n    RequestMessage.hello = function (userAgent, authToken, routing) {\n        if (routing === void 0) { routing = null; }\n        var metadata = Object.assign({ user_agent: userAgent }, authToken);\n        if (routing) {\n            metadata.routing = routing;\n        }\n        return new RequestMessage(HELLO, [metadata], function () { return \"HELLO {user_agent: '\" + userAgent + \"', ...}\"; });\n    };\n    /**\n     * Create a new BEGIN message.\n     * @param {Bookmark} bookmark the bookmark.\n     * @param {TxConfig} txConfig the configuration.\n     * @param {string} database the database name.\n     * @param {string} mode the access mode.\n     * @param {string} impersonatedUser the impersonated user.\n     * @return {RequestMessage} new BEGIN message.\n     */\n    RequestMessage.begin = function (_a) {\n        var _b = _a === void 0 ? {} : _a, bookmark = _b.bookmark, txConfig = _b.txConfig, database = _b.database, mode = _b.mode, impersonatedUser = _b.impersonatedUser;\n        var metadata = buildTxMetadata(bookmark, txConfig, database, mode, impersonatedUser);\n        return new RequestMessage(BEGIN, [metadata], function () { return \"BEGIN \" + neo4j_driver_core_1.json.stringify(metadata); });\n    };\n    /**\n     * Get a COMMIT message.\n     * @return {RequestMessage} the COMMIT message.\n     */\n    RequestMessage.commit = function () {\n        return COMMIT_MESSAGE;\n    };\n    /**\n     * Get a ROLLBACK message.\n     * @return {RequestMessage} the ROLLBACK message.\n     */\n    RequestMessage.rollback = function () {\n        return ROLLBACK_MESSAGE;\n    };\n    /**\n     * Create a new RUN message with additional metadata.\n     * @param {string} query the cypher query.\n     * @param {Object} parameters the query parameters.\n     * @param {Bookmark} bookmark the bookmark.\n     * @param {TxConfig} txConfig the configuration.\n     * @param {string} database the database name.\n     * @param {string} mode the access mode.\n     * @param {string} impersonatedUser the impersonated user.\n     * @return {RequestMessage} new RUN message with additional metadata.\n     */\n    RequestMessage.runWithMetadata = function (query, parameters, _a) {\n        var _b = _a === void 0 ? {} : _a, bookmark = _b.bookmark, txConfig = _b.txConfig, database = _b.database, mode = _b.mode, impersonatedUser = _b.impersonatedUser;\n        var metadata = buildTxMetadata(bookmark, txConfig, database, mode, impersonatedUser);\n        return new RequestMessage(RUN, [query, parameters, metadata], function () {\n            return \"RUN \" + query + \" \" + neo4j_driver_core_1.json.stringify(parameters) + \" \" + neo4j_driver_core_1.json.stringify(metadata);\n        });\n    };\n    /**\n     * Get a GOODBYE message.\n     * @return {RequestMessage} the GOODBYE message.\n     */\n    RequestMessage.goodbye = function () {\n        return GOODBYE_MESSAGE;\n    };\n    /**\n     * Generates a new PULL message with additional metadata.\n     * @param {Integer|number} stmtId\n     * @param {Integer|number} n\n     * @return {RequestMessage} the PULL message.\n     */\n    RequestMessage.pull = function (_a) {\n        var _b = _a === void 0 ? {} : _a, _c = _b.stmtId, stmtId = _c === void 0 ? NO_STATEMENT_ID : _c, _d = _b.n, n = _d === void 0 ? FETCH_ALL : _d;\n        var metadata = buildStreamMetadata(stmtId === null || stmtId === undefined ? NO_STATEMENT_ID : stmtId, n || FETCH_ALL);\n        return new RequestMessage(PULL, [metadata], function () { return \"PULL \" + neo4j_driver_core_1.json.stringify(metadata); });\n    };\n    /**\n     * Generates a new DISCARD message with additional metadata.\n     * @param {Integer|number} stmtId\n     * @param {Integer|number} n\n     * @return {RequestMessage} the PULL message.\n     */\n    RequestMessage.discard = function (_a) {\n        var _b = _a === void 0 ? {} : _a, _c = _b.stmtId, stmtId = _c === void 0 ? NO_STATEMENT_ID : _c, _d = _b.n, n = _d === void 0 ? FETCH_ALL : _d;\n        var metadata = buildStreamMetadata(stmtId === null || stmtId === undefined ? NO_STATEMENT_ID : stmtId, n || FETCH_ALL);\n        return new RequestMessage(DISCARD, [metadata], function () { return \"DISCARD \" + neo4j_driver_core_1.json.stringify(metadata); });\n    };\n    /**\n     * Generate the ROUTE message, this message is used to fetch the routing table from the server\n     *\n     * @param {object} routingContext The routing context used to define the routing table. Multi-datacenter deployments is one of its use cases\n     * @param {string[]} bookmarks The list of the bookmark should be used\n     * @param {string} databaseName The name of the database to get the routing table for.\n     * @return {RequestMessage} the ROUTE message.\n     */\n    RequestMessage.route = function (routingContext, bookmarks, databaseName) {\n        if (routingContext === void 0) { routingContext = {}; }\n        if (bookmarks === void 0) { bookmarks = []; }\n        if (databaseName === void 0) { databaseName = null; }\n        return new RequestMessage(ROUTE, [routingContext, bookmarks, databaseName], function () {\n            return \"ROUTE \" + neo4j_driver_core_1.json.stringify(routingContext) + \" \" + neo4j_driver_core_1.json.stringify(bookmarks) + \" \" + databaseName;\n        });\n    };\n    /**\n     * Generate the ROUTE message, this message is used to fetch the routing table from the server\n     *\n     * @param {object} routingContext The routing context used to define the routing table. Multi-datacenter deployments is one of its use cases\n     * @param {string[]} bookmarks The list of the bookmark should be used\n     * @param {object} databaseContext The context inforamtion of the database to get the routing table for.\n     * @param {string} databaseContext.databaseName The name of the database to get the routing table.\n     * @param {string} databaseContext.impersonatedUser The name of the user to impersonation when getting the routing table.\n     * @return {RequestMessage} the ROUTE message.\n     */\n    RequestMessage.routeV4x4 = function (routingContext, bookmarks, databaseContext) {\n        if (routingContext === void 0) { routingContext = {}; }\n        if (bookmarks === void 0) { bookmarks = []; }\n        if (databaseContext === void 0) { databaseContext = {}; }\n        var dbContext = {};\n        if (databaseContext.databaseName) {\n            dbContext.db = databaseContext.databaseName;\n        }\n        if (databaseContext.impersonatedUser) {\n            dbContext.imp_user = databaseContext.impersonatedUser;\n        }\n        return new RequestMessage(ROUTE, [routingContext, bookmarks, dbContext], function () {\n            return \"ROUTE \" + neo4j_driver_core_1.json.stringify(routingContext) + \" \" + neo4j_driver_core_1.json.stringify(bookmarks) + \" \" + neo4j_driver_core_1.json.stringify(dbContext);\n        });\n    };\n    return RequestMessage;\n}());\nexports.default = RequestMessage;\n/**\n * Create an object that represent transaction metadata.\n * @param {Bookmark} bookmark the bookmark.\n * @param {TxConfig} txConfig the configuration.\n * @param {string} database the database name.\n * @param {string} mode the access mode.\n * @param {string} impersonatedUser the impersonated user mode.\n * @return {Object} a metadata object.\n */\nfunction buildTxMetadata(bookmark, txConfig, database, mode, impersonatedUser) {\n    var metadata = {};\n    if (!bookmark.isEmpty()) {\n        metadata.bookmarks = bookmark.values();\n    }\n    if (txConfig.timeout) {\n        metadata.tx_timeout = txConfig.timeout;\n    }\n    if (txConfig.metadata) {\n        metadata.tx_metadata = txConfig.metadata;\n    }\n    if (database) {\n        metadata.db = assertString(database, 'database');\n    }\n    if (impersonatedUser) {\n        metadata.imp_user = assertString(impersonatedUser, 'impersonatedUser');\n    }\n    if (mode === ACCESS_MODE_READ) {\n        metadata.mode = READ_MODE;\n    }\n    return metadata;\n}\n/**\n * Create an object that represents streaming metadata.\n * @param {Integer|number} stmtId The query id to stream its results.\n * @param {Integer|number} n The number of records to stream.\n * @returns {Object} a metadata object.\n */\nfunction buildStreamMetadata(stmtId, n) {\n    var metadata = { n: (0, neo4j_driver_core_1.int)(n) };\n    if (stmtId !== NO_STATEMENT_ID) {\n        metadata.qid = (0, neo4j_driver_core_1.int)(stmtId);\n    }\n    return metadata;\n}\n// constants for messages that never change\nvar PULL_ALL_MESSAGE = new RequestMessage(PULL_ALL, [], function () { return 'PULL_ALL'; });\nvar RESET_MESSAGE = new RequestMessage(RESET, [], function () { return 'RESET'; });\nvar COMMIT_MESSAGE = new RequestMessage(COMMIT, [], function () { return 'COMMIT'; });\nvar ROLLBACK_MESSAGE = new RequestMessage(ROLLBACK, [], function () { return 'ROLLBACK'; });\nvar GOODBYE_MESSAGE = new RequestMessage(GOODBYE, [], function () { return 'GOODBYE'; });\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}