{"ast":null,"code":"import { select } from 'd3-selection';\nimport { zoomTransform, zoom } from 'd3-zoom';\nimport { drag } from 'd3-drag';\nimport { min, max } from 'd3-array';\nimport throttle from 'lodash.throttle';\nimport TWEEN from '@tweenjs/tween.js';\nimport Kapsule from 'kapsule';\nimport accessorFn from 'accessor-fn';\nimport ColorTracker from 'canvas-color-tracker';\nimport { forceSimulation, forceLink, forceManyBody, forceCenter, forceRadial } from 'd3-force-3d';\nimport { Bezier } from 'bezier-js';\nimport indexBy from 'index-array-by';\nimport { scaleOrdinal } from 'd3-scale';\nimport { schemePaired } from 'd3-scale-chromatic';\n\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".force-graph-container canvas {\\n  display: block;\\n  user-select: none;\\n  outline: none;\\n  -webkit-tap-highlight-color: transparent;\\n}\\n\\n.force-graph-container .graph-tooltip {\\n  position: absolute;\\n  top: 0;\\n  transform: translate(-50%, 25px);\\n  font-family: sans-serif;\\n  font-size: 16px;\\n  padding: 4px;\\n  border-radius: 3px;\\n  color: #eee;\\n  background: rgba(0,0,0,0.65);\\n  visibility: hidden; /* by default */\\n}\\n\\n.force-graph-container .clickable {\\n  cursor: pointer;\\n}\\n\\n.force-graph-container .grabbable {\\n  cursor: move;\\n  cursor: grab;\\n  cursor: -moz-grab;\\n  cursor: -webkit-grab;\\n}\\n\\n.force-graph-container .grabbable:active {\\n  cursor: grabbing;\\n  cursor: -moz-grabbing;\\n  cursor: -webkit-grabbing;\\n}\\n\";\nstyleInject(css_248z);\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _construct(Parent, args, Class) {\n  if (_isNativeReflectConstruct()) {\n    _construct = Reflect.construct.bind();\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) _setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar autoColorScale = scaleOrdinal(schemePaired); // Autoset attribute colorField by colorByAccessor property\n// If an object has already a color, don't set it\n// Objects can be nodes or links\n\nfunction autoColorObjects(objects, colorByAccessor, colorField) {\n  if (!colorByAccessor || typeof colorField !== 'string') return;\n  objects.filter(function (obj) {\n    return !obj[colorField];\n  }).forEach(function (obj) {\n    obj[colorField] = autoColorScale(colorByAccessor(obj));\n  });\n}\n\nfunction getDagDepths(_ref, idAccessor) {\n  var nodes = _ref.nodes,\n      links = _ref.links;\n\n  var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      _ref2$nodeFilter = _ref2.nodeFilter,\n      nodeFilter = _ref2$nodeFilter === void 0 ? function () {\n    return true;\n  } : _ref2$nodeFilter,\n      _ref2$onLoopError = _ref2.onLoopError,\n      onLoopError = _ref2$onLoopError === void 0 ? function (loopIds) {\n    throw \"Invalid DAG structure! Found cycle in node path: \".concat(loopIds.join(' -> '), \".\");\n  } : _ref2$onLoopError; // linked graph\n\n\n  var graph = {};\n  nodes.forEach(function (node) {\n    return graph[idAccessor(node)] = {\n      data: node,\n      out: [],\n      depth: -1,\n      skip: !nodeFilter(node)\n    };\n  });\n  links.forEach(function (_ref3) {\n    var source = _ref3.source,\n        target = _ref3.target;\n    var sourceId = getNodeId(source);\n    var targetId = getNodeId(target);\n    if (!graph.hasOwnProperty(sourceId)) throw \"Missing source node with id: \".concat(sourceId);\n    if (!graph.hasOwnProperty(targetId)) throw \"Missing target node with id: \".concat(targetId);\n    var sourceNode = graph[sourceId];\n    var targetNode = graph[targetId];\n    sourceNode.out.push(targetNode);\n\n    function getNodeId(node) {\n      return _typeof(node) === 'object' ? idAccessor(node) : node;\n    }\n  });\n  var foundLoops = [];\n  traverse(Object.values(graph));\n  var nodeDepths = Object.assign.apply(Object, [{}].concat(_toConsumableArray(Object.entries(graph).filter(function (_ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n        node = _ref5[1];\n\n    return !node.skip;\n  }).map(function (_ref6) {\n    var _ref7 = _slicedToArray(_ref6, 2),\n        id = _ref7[0],\n        node = _ref7[1];\n\n    return _defineProperty({}, id, node.depth);\n  }))));\n  return nodeDepths;\n\n  function traverse(nodes) {\n    var nodeStack = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var currentDepth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n    for (var i = 0, l = nodes.length; i < l; i++) {\n      var node = nodes[i];\n\n      if (nodeStack.indexOf(node) !== -1) {\n        var _ret = function () {\n          var loop = [].concat(_toConsumableArray(nodeStack.slice(nodeStack.indexOf(node))), [node]).map(function (d) {\n            return idAccessor(d.data);\n          });\n\n          if (!foundLoops.some(function (foundLoop) {\n            return foundLoop.length === loop.length && foundLoop.every(function (id, idx) {\n              return id === loop[idx];\n            });\n          })) {\n            foundLoops.push(loop);\n            onLoopError(loop);\n          }\n\n          return \"continue\";\n        }();\n\n        if (_ret === \"continue\") continue;\n      }\n\n      if (currentDepth > node.depth) {\n        // Don't unnecessarily revisit chunks of the graph\n        node.depth = currentDepth;\n        traverse(node.out, [].concat(_toConsumableArray(nodeStack), [node]), currentDepth + (node.skip ? 0 : 1));\n      }\n    }\n  }\n}\n\nvar DAG_LEVEL_NODE_RATIO = 2; // whenever styling props are changed that require a canvas redraw\n\nvar notifyRedraw = function notifyRedraw(_, state) {\n  return state.onNeedsRedraw && state.onNeedsRedraw();\n};\n\nvar CanvasForceGraph = Kapsule({\n  props: {\n    graphData: {\n      \"default\": {\n        nodes: [],\n        links: []\n      },\n      onChange: function onChange(_, state) {\n        state.engineRunning = false;\n      } // Pause simulation\n\n    },\n    dagMode: {\n      onChange: function onChange(dagMode, state) {\n        // td, bu, lr, rl, radialin, radialout\n        !dagMode && (state.graphData.nodes || []).forEach(function (n) {\n          return n.fx = n.fy = undefined;\n        }); // unfix nodes when disabling dag mode\n      }\n    },\n    dagLevelDistance: {},\n    dagNodeFilter: {\n      \"default\": function _default(node) {\n        return true;\n      }\n    },\n    onDagError: {\n      triggerUpdate: false\n    },\n    nodeRelSize: {\n      \"default\": 4,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    // area per val unit\n    nodeId: {\n      \"default\": 'id'\n    },\n    nodeVal: {\n      \"default\": 'val',\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeColor: {\n      \"default\": 'color',\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeAutoColorBy: {},\n    nodeCanvasObject: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeCanvasObjectMode: {\n      \"default\": function _default() {\n        return 'replace';\n      },\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeVisibility: {\n      \"default\": true,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkSource: {\n      \"default\": 'source'\n    },\n    linkTarget: {\n      \"default\": 'target'\n    },\n    linkVisibility: {\n      \"default\": true,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkColor: {\n      \"default\": 'color',\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkAutoColorBy: {},\n    linkLineDash: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkWidth: {\n      \"default\": 1,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkCurvature: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkCanvasObject: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkCanvasObjectMode: {\n      \"default\": function _default() {\n        return 'replace';\n      },\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkDirectionalArrowLength: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkDirectionalArrowColor: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkDirectionalArrowRelPos: {\n      \"default\": 0.5,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    // value between 0<>1 indicating the relative pos along the (exposed) line\n    linkDirectionalParticles: {\n      \"default\": 0\n    },\n    // animate photons travelling in the link direction\n    linkDirectionalParticleSpeed: {\n      \"default\": 0.01,\n      triggerUpdate: false\n    },\n    // in link length ratio per frame\n    linkDirectionalParticleWidth: {\n      \"default\": 4,\n      triggerUpdate: false\n    },\n    linkDirectionalParticleColor: {\n      triggerUpdate: false\n    },\n    globalScale: {\n      \"default\": 1,\n      triggerUpdate: false\n    },\n    d3AlphaMin: {\n      \"default\": 0,\n      triggerUpdate: false\n    },\n    d3AlphaDecay: {\n      \"default\": 0.0228,\n      triggerUpdate: false,\n      onChange: function onChange(alphaDecay, state) {\n        state.forceLayout.alphaDecay(alphaDecay);\n      }\n    },\n    d3AlphaTarget: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: function onChange(alphaTarget, state) {\n        state.forceLayout.alphaTarget(alphaTarget);\n      }\n    },\n    d3VelocityDecay: {\n      \"default\": 0.4,\n      triggerUpdate: false,\n      onChange: function onChange(velocityDecay, state) {\n        state.forceLayout.velocityDecay(velocityDecay);\n      }\n    },\n    warmupTicks: {\n      \"default\": 0,\n      triggerUpdate: false\n    },\n    // how many times to tick the force engine at init before starting to render\n    cooldownTicks: {\n      \"default\": Infinity,\n      triggerUpdate: false\n    },\n    cooldownTime: {\n      \"default\": 15000,\n      triggerUpdate: false\n    },\n    // ms\n    onUpdate: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onFinishUpdate: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onEngineTick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onEngineStop: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNeedsRedraw: {\n      triggerUpdate: false\n    },\n    isShadow: {\n      \"default\": false,\n      triggerUpdate: false\n    }\n  },\n  methods: {\n    // Expose d3 forces for external manipulation\n    d3Force: function d3Force(state, forceName, forceFn) {\n      if (forceFn === undefined) {\n        return state.forceLayout.force(forceName); // Force getter\n      }\n\n      state.forceLayout.force(forceName, forceFn); // Force setter\n\n      return this;\n    },\n    d3ReheatSimulation: function d3ReheatSimulation(state) {\n      state.forceLayout.alpha(1);\n      this.resetCountdown();\n      return this;\n    },\n    // reset cooldown state\n    resetCountdown: function resetCountdown(state) {\n      state.cntTicks = 0;\n      state.startTickTime = new Date();\n      state.engineRunning = true;\n      return this;\n    },\n    isEngineRunning: function isEngineRunning(state) {\n      return !!state.engineRunning;\n    },\n    tickFrame: function tickFrame(state) {\n      !state.isShadow && layoutTick();\n      paintLinks();\n      !state.isShadow && paintArrows();\n      !state.isShadow && paintPhotons();\n      paintNodes();\n      return this; //\n\n      function layoutTick() {\n        if (state.engineRunning) {\n          if (++state.cntTicks > state.cooldownTicks || new Date() - state.startTickTime > state.cooldownTime || state.d3AlphaMin > 0 && state.forceLayout.alpha() < state.d3AlphaMin) {\n            state.engineRunning = false; // Stop ticking graph\n\n            state.onEngineStop();\n          } else {\n            state.forceLayout.tick(); // Tick it\n\n            state.onEngineTick();\n          }\n        }\n      }\n\n      function paintNodes() {\n        var getVisibility = accessorFn(state.nodeVisibility);\n        var getVal = accessorFn(state.nodeVal);\n        var getColor = accessorFn(state.nodeColor);\n        var getNodeCanvasObjectMode = accessorFn(state.nodeCanvasObjectMode);\n        var ctx = state.ctx; // Draw wider nodes by 1px on shadow canvas for more precise hovering (due to boundary anti-aliasing)\n\n        var padAmount = state.isShadow / state.globalScale;\n        var visibleNodes = state.graphData.nodes.filter(getVisibility);\n        ctx.save();\n        visibleNodes.forEach(function (node) {\n          var nodeCanvasObjectMode = getNodeCanvasObjectMode(node);\n\n          if (state.nodeCanvasObject && (nodeCanvasObjectMode === 'before' || nodeCanvasObjectMode === 'replace')) {\n            // Custom node before/replace paint\n            state.nodeCanvasObject(node, ctx, state.globalScale);\n\n            if (nodeCanvasObjectMode === 'replace') {\n              ctx.restore();\n              return;\n            }\n          } // Draw wider nodes by 1px on shadow canvas for more precise hovering (due to boundary anti-aliasing)\n\n\n          var r = Math.sqrt(Math.max(0, getVal(node) || 1)) * state.nodeRelSize + padAmount;\n          ctx.beginPath();\n          ctx.arc(node.x, node.y, r, 0, 2 * Math.PI, false);\n          ctx.fillStyle = getColor(node) || 'rgba(31, 120, 180, 0.92)';\n          ctx.fill();\n\n          if (state.nodeCanvasObject && nodeCanvasObjectMode === 'after') {\n            // Custom node after paint\n            state.nodeCanvasObject(node, state.ctx, state.globalScale);\n          }\n        });\n        ctx.restore();\n      }\n\n      function paintLinks() {\n        var getVisibility = accessorFn(state.linkVisibility);\n        var getColor = accessorFn(state.linkColor);\n        var getWidth = accessorFn(state.linkWidth);\n        var getLineDash = accessorFn(state.linkLineDash);\n        var getCurvature = accessorFn(state.linkCurvature);\n        var getLinkCanvasObjectMode = accessorFn(state.linkCanvasObjectMode);\n        var ctx = state.ctx; // Draw wider lines by 2px on shadow canvas for more precise hovering (due to boundary anti-aliasing)\n\n        var padAmount = state.isShadow * 2;\n        var visibleLinks = state.graphData.links.filter(getVisibility);\n        visibleLinks.forEach(calcLinkControlPoints); // calculate curvature control points for all visible links\n\n        var beforeCustomLinks = [],\n            afterCustomLinks = [],\n            defaultPaintLinks = visibleLinks;\n\n        if (state.linkCanvasObject) {\n          var replaceCustomLinks = [],\n              otherCustomLinks = [];\n          visibleLinks.forEach(function (d) {\n            return ({\n              before: beforeCustomLinks,\n              after: afterCustomLinks,\n              replace: replaceCustomLinks\n            }[getLinkCanvasObjectMode(d)] || otherCustomLinks).push(d);\n          });\n          defaultPaintLinks = [].concat(_toConsumableArray(beforeCustomLinks), afterCustomLinks, otherCustomLinks);\n          beforeCustomLinks = beforeCustomLinks.concat(replaceCustomLinks);\n        } // Custom link before paints\n\n\n        ctx.save();\n        beforeCustomLinks.forEach(function (link) {\n          return state.linkCanvasObject(link, ctx, state.globalScale);\n        });\n        ctx.restore(); // Bundle strokes per unique color/width/dash for performance optimization\n\n        var linksPerColor = indexBy(defaultPaintLinks, [getColor, getWidth, getLineDash]);\n        ctx.save();\n        Object.entries(linksPerColor).forEach(function (_ref) {\n          var _ref2 = _slicedToArray(_ref, 2),\n              color = _ref2[0],\n              linksPerWidth = _ref2[1];\n\n          var lineColor = !color || color === 'undefined' ? 'rgba(0,0,0,0.15)' : color;\n          Object.entries(linksPerWidth).forEach(function (_ref3) {\n            var _ref4 = _slicedToArray(_ref3, 2),\n                width = _ref4[0],\n                linesPerLineDash = _ref4[1];\n\n            var lineWidth = (width || 1) / state.globalScale + padAmount;\n            Object.entries(linesPerLineDash).forEach(function (_ref5) {\n              var _ref6 = _slicedToArray(_ref5, 2);\n\n              _ref6[0];\n              var links = _ref6[1];\n              var lineDashSegments = getLineDash(links[0]);\n              ctx.beginPath();\n              links.forEach(function (link) {\n                var start = link.source;\n                var end = link.target;\n                if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n                ctx.moveTo(start.x, start.y);\n                var controlPoints = link.__controlPoints;\n\n                if (!controlPoints) {\n                  // Straight line\n                  ctx.lineTo(end.x, end.y);\n                } else {\n                  // Use quadratic curves for regular lines and bezier for loops\n                  ctx[controlPoints.length === 2 ? 'quadraticCurveTo' : 'bezierCurveTo'].apply(ctx, _toConsumableArray(controlPoints).concat([end.x, end.y]));\n                }\n              });\n              ctx.strokeStyle = lineColor;\n              ctx.lineWidth = lineWidth;\n              ctx.setLineDash(lineDashSegments || []);\n              ctx.stroke();\n            });\n          });\n        });\n        ctx.restore(); // Custom link after paints\n\n        ctx.save();\n        afterCustomLinks.forEach(function (link) {\n          return state.linkCanvasObject(link, ctx, state.globalScale);\n        });\n        ctx.restore(); //\n\n        function calcLinkControlPoints(link) {\n          var curvature = getCurvature(link);\n\n          if (!curvature) {\n            // straight line\n            link.__controlPoints = null;\n            return;\n          }\n\n          var start = link.source;\n          var end = link.target;\n          if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n          var l = Math.sqrt(Math.pow(end.x - start.x, 2) + Math.pow(end.y - start.y, 2)); // line length\n\n          if (l > 0) {\n            var a = Math.atan2(end.y - start.y, end.x - start.x); // line angle\n\n            var d = l * curvature; // control point distance\n\n            var cp = {\n              // control point\n              x: (start.x + end.x) / 2 + d * Math.cos(a - Math.PI / 2),\n              y: (start.y + end.y) / 2 + d * Math.sin(a - Math.PI / 2)\n            };\n            link.__controlPoints = [cp.x, cp.y];\n          } else {\n            // Same point, draw a loop\n            var _d = curvature * 70;\n\n            link.__controlPoints = [end.x, end.y - _d, end.x + _d, end.y];\n          }\n        }\n      }\n\n      function paintArrows() {\n        var ARROW_WH_RATIO = 1.6;\n        var ARROW_VLEN_RATIO = 0.2;\n        var getLength = accessorFn(state.linkDirectionalArrowLength);\n        var getRelPos = accessorFn(state.linkDirectionalArrowRelPos);\n        var getVisibility = accessorFn(state.linkVisibility);\n        var getColor = accessorFn(state.linkDirectionalArrowColor || state.linkColor);\n        var getNodeVal = accessorFn(state.nodeVal);\n        var ctx = state.ctx;\n        ctx.save();\n        state.graphData.links.filter(getVisibility).forEach(function (link) {\n          var arrowLength = getLength(link);\n          if (!arrowLength || arrowLength < 0) return;\n          var start = link.source;\n          var end = link.target;\n          if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n          var startR = Math.sqrt(Math.max(0, getNodeVal(start) || 1)) * state.nodeRelSize;\n          var endR = Math.sqrt(Math.max(0, getNodeVal(end) || 1)) * state.nodeRelSize;\n          var arrowRelPos = Math.min(1, Math.max(0, getRelPos(link)));\n          var arrowColor = getColor(link) || 'rgba(0,0,0,0.28)';\n          var arrowHalfWidth = arrowLength / ARROW_WH_RATIO / 2; // Construct bezier for curved lines\n\n          var bzLine = link.__controlPoints && _construct(Bezier, [start.x, start.y].concat(_toConsumableArray(link.__controlPoints), [end.x, end.y]));\n\n          var getCoordsAlongLine = bzLine ? function (t) {\n            return bzLine.get(t);\n          } // get position along bezier line\n          : function (t) {\n            return {\n              // straight line: interpolate linearly\n              x: start.x + (end.x - start.x) * t || 0,\n              y: start.y + (end.y - start.y) * t || 0\n            };\n          };\n          var lineLen = bzLine ? bzLine.length() : Math.sqrt(Math.pow(end.x - start.x, 2) + Math.pow(end.y - start.y, 2));\n          var posAlongLine = startR + arrowLength + (lineLen - startR - endR - arrowLength) * arrowRelPos;\n          var arrowHead = getCoordsAlongLine(posAlongLine / lineLen);\n          var arrowTail = getCoordsAlongLine((posAlongLine - arrowLength) / lineLen);\n          var arrowTailVertex = getCoordsAlongLine((posAlongLine - arrowLength * (1 - ARROW_VLEN_RATIO)) / lineLen);\n          var arrowTailAngle = Math.atan2(arrowHead.y - arrowTail.y, arrowHead.x - arrowTail.x) - Math.PI / 2;\n          ctx.beginPath();\n          ctx.moveTo(arrowHead.x, arrowHead.y);\n          ctx.lineTo(arrowTail.x + arrowHalfWidth * Math.cos(arrowTailAngle), arrowTail.y + arrowHalfWidth * Math.sin(arrowTailAngle));\n          ctx.lineTo(arrowTailVertex.x, arrowTailVertex.y);\n          ctx.lineTo(arrowTail.x - arrowHalfWidth * Math.cos(arrowTailAngle), arrowTail.y - arrowHalfWidth * Math.sin(arrowTailAngle));\n          ctx.fillStyle = arrowColor;\n          ctx.fill();\n        });\n        ctx.restore();\n      }\n\n      function paintPhotons() {\n        var getNumPhotons = accessorFn(state.linkDirectionalParticles);\n        var getSpeed = accessorFn(state.linkDirectionalParticleSpeed);\n        var getDiameter = accessorFn(state.linkDirectionalParticleWidth);\n        var getVisibility = accessorFn(state.linkVisibility);\n        var getColor = accessorFn(state.linkDirectionalParticleColor || state.linkColor);\n        var ctx = state.ctx;\n        ctx.save();\n        state.graphData.links.filter(getVisibility).forEach(function (link) {\n          var numCyclePhotons = getNumPhotons(link);\n          if (!link.hasOwnProperty('__photons') || !link.__photons.length) return;\n          var start = link.source;\n          var end = link.target;\n          if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n          var particleSpeed = getSpeed(link);\n          var photons = link.__photons || [];\n          var photonR = Math.max(0, getDiameter(link) / 2) / Math.sqrt(state.globalScale);\n          var photonColor = getColor(link) || 'rgba(0,0,0,0.28)';\n          ctx.fillStyle = photonColor; // Construct bezier for curved lines\n\n          var bzLine = link.__controlPoints ? _construct(Bezier, [start.x, start.y].concat(_toConsumableArray(link.__controlPoints), [end.x, end.y])) : null;\n          var cyclePhotonIdx = 0;\n          var needsCleanup = false; // whether some photons need to be removed from list\n\n          photons.forEach(function (photon) {\n            var singleHop = !!photon.__singleHop;\n\n            if (!photon.hasOwnProperty('__progressRatio')) {\n              photon.__progressRatio = singleHop ? 0 : cyclePhotonIdx / numCyclePhotons;\n            }\n\n            !singleHop && cyclePhotonIdx++; // increase regular photon index\n\n            photon.__progressRatio += particleSpeed;\n\n            if (photon.__progressRatio >= 1) {\n              if (!singleHop) {\n                photon.__progressRatio = photon.__progressRatio % 1;\n              } else {\n                needsCleanup = true;\n                return;\n              }\n            }\n\n            var photonPosRatio = photon.__progressRatio;\n            var coords = bzLine ? bzLine.get(photonPosRatio) // get position along bezier line\n            : {\n              // straight line: interpolate linearly\n              x: start.x + (end.x - start.x) * photonPosRatio || 0,\n              y: start.y + (end.y - start.y) * photonPosRatio || 0\n            };\n            ctx.beginPath();\n            ctx.arc(coords.x, coords.y, photonR, 0, 2 * Math.PI, false);\n            ctx.fill();\n          });\n\n          if (needsCleanup) {\n            // remove expired single hop photons\n            link.__photons = link.__photons.filter(function (photon) {\n              return !photon.__singleHop || photon.__progressRatio <= 1;\n            });\n          }\n        });\n        ctx.restore();\n      }\n    },\n    emitParticle: function emitParticle(state, link) {\n      if (link) {\n        !link.__photons && (link.__photons = []);\n\n        link.__photons.push({\n          __singleHop: true\n        }); // add a single hop particle\n\n      }\n\n      return this;\n    }\n  },\n  stateInit: function stateInit() {\n    return {\n      forceLayout: forceSimulation().force('link', forceLink()).force('charge', forceManyBody()).force('center', forceCenter()).force('dagRadial', null).stop(),\n      engineRunning: false\n    };\n  },\n  init: function init(canvasCtx, state) {\n    // Main canvas object to manipulate\n    state.ctx = canvasCtx;\n  },\n  update: function update(state) {\n    state.engineRunning = false; // Pause simulation\n\n    state.onUpdate();\n\n    if (state.nodeAutoColorBy !== null) {\n      // Auto add color to uncolored nodes\n      autoColorObjects(state.graphData.nodes, accessorFn(state.nodeAutoColorBy), state.nodeColor);\n    }\n\n    if (state.linkAutoColorBy !== null) {\n      // Auto add color to uncolored links\n      autoColorObjects(state.graphData.links, accessorFn(state.linkAutoColorBy), state.linkColor);\n    } // parse links\n\n\n    state.graphData.links.forEach(function (link) {\n      link.source = link[state.linkSource];\n      link.target = link[state.linkTarget];\n    });\n\n    if (!state.isShadow) {\n      // Add photon particles\n      var linkParticlesAccessor = accessorFn(state.linkDirectionalParticles);\n      state.graphData.links.forEach(function (link) {\n        var numPhotons = Math.round(Math.abs(linkParticlesAccessor(link)));\n\n        if (numPhotons) {\n          link.__photons = _toConsumableArray(Array(numPhotons)).map(function () {\n            return {};\n          });\n        } else {\n          delete link.__photons;\n        }\n      });\n    } // Feed data to force-directed layout\n\n\n    state.forceLayout.stop().alpha(1) // re-heat the simulation\n    .nodes(state.graphData.nodes); // add links (if link force is still active)\n\n    var linkForce = state.forceLayout.force('link');\n\n    if (linkForce) {\n      linkForce.id(function (d) {\n        return d[state.nodeId];\n      }).links(state.graphData.links);\n    } // setup dag force constraints\n\n\n    var nodeDepths = state.dagMode && getDagDepths(state.graphData, function (node) {\n      return node[state.nodeId];\n    }, {\n      nodeFilter: state.dagNodeFilter,\n      onLoopError: state.onDagError || undefined\n    });\n    var maxDepth = Math.max.apply(Math, _toConsumableArray(Object.values(nodeDepths || [])));\n    var dagLevelDistance = state.dagLevelDistance || state.graphData.nodes.length / (maxDepth || 1) * DAG_LEVEL_NODE_RATIO * (['radialin', 'radialout'].indexOf(state.dagMode) !== -1 ? 0.7 : 1); // Fix nodes to x,y for dag mode\n\n    if (state.dagMode) {\n      var getFFn = function getFFn(fix, invert) {\n        return function (node) {\n          return !fix ? undefined : (nodeDepths[node[state.nodeId]] - maxDepth / 2) * dagLevelDistance * (invert ? -1 : 1);\n        };\n      };\n\n      var fxFn = getFFn(['lr', 'rl'].indexOf(state.dagMode) !== -1, state.dagMode === 'rl');\n      var fyFn = getFFn(['td', 'bu'].indexOf(state.dagMode) !== -1, state.dagMode === 'bu');\n      state.graphData.nodes.filter(state.dagNodeFilter).forEach(function (node) {\n        node.fx = fxFn(node);\n        node.fy = fyFn(node);\n      });\n    } // Use radial force for radial dags\n\n\n    state.forceLayout.force('dagRadial', ['radialin', 'radialout'].indexOf(state.dagMode) !== -1 ? forceRadial(function (node) {\n      var nodeDepth = nodeDepths[node[state.nodeId]] || -1;\n      return (state.dagMode === 'radialin' ? maxDepth - nodeDepth : nodeDepth) * dagLevelDistance;\n    }).strength(function (node) {\n      return state.dagNodeFilter(node) ? 1 : 0;\n    }) : null);\n\n    for (var i = 0; i < state.warmupTicks && !(state.d3AlphaMin > 0 && state.forceLayout.alpha() < state.d3AlphaMin); i++) {\n      state.forceLayout.tick();\n    } // Initial ticks before starting to render\n\n\n    this.resetCountdown();\n    state.onFinishUpdate();\n  }\n});\n\nfunction linkKapsule(kapsulePropNames, kapsuleType) {\n  var propNames = kapsulePropNames instanceof Array ? kapsulePropNames : [kapsulePropNames];\n  var dummyK = new kapsuleType(); // To extract defaults\n\n  return {\n    linkProp: function linkProp(prop) {\n      // link property config\n      return {\n        \"default\": dummyK[prop](),\n        onChange: function onChange(v, state) {\n          propNames.forEach(function (propName) {\n            return state[propName][prop](v);\n          });\n        },\n        triggerUpdate: false\n      };\n    },\n    linkMethod: function linkMethod(method) {\n      // link method pass-through\n      return function (state) {\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        var returnVals = [];\n        propNames.forEach(function (propName) {\n          var kapsuleInstance = state[propName];\n          var returnVal = kapsuleInstance[method].apply(kapsuleInstance, args);\n\n          if (returnVal !== kapsuleInstance) {\n            returnVals.push(returnVal);\n          }\n        });\n        return returnVals.length ? returnVals[0] : this; // chain based on the parent object, not the inner kapsule\n      };\n    }\n  };\n}\n\nvar HOVER_CANVAS_THROTTLE_DELAY = 800; // ms to throttle shadow canvas updates for perf improvement\n\nvar ZOOM2NODES_FACTOR = 4; // Expose config from forceGraph\n\nvar bindFG = linkKapsule('forceGraph', CanvasForceGraph);\nvar bindBoth = linkKapsule(['forceGraph', 'shadowGraph'], CanvasForceGraph);\nvar linkedProps = Object.assign.apply(Object, _toConsumableArray(['nodeColor', 'nodeAutoColorBy', 'nodeCanvasObject', 'nodeCanvasObjectMode', 'linkColor', 'linkAutoColorBy', 'linkLineDash', 'linkWidth', 'linkCanvasObject', 'linkCanvasObjectMode', 'linkDirectionalArrowLength', 'linkDirectionalArrowColor', 'linkDirectionalArrowRelPos', 'linkDirectionalParticles', 'linkDirectionalParticleSpeed', 'linkDirectionalParticleWidth', 'linkDirectionalParticleColor', 'dagMode', 'dagLevelDistance', 'dagNodeFilter', 'onDagError', 'd3AlphaMin', 'd3AlphaDecay', 'd3VelocityDecay', 'warmupTicks', 'cooldownTicks', 'cooldownTime', 'onEngineTick', 'onEngineStop'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkProp(p));\n})).concat(_toConsumableArray(['nodeRelSize', 'nodeId', 'nodeVal', 'nodeVisibility', 'linkSource', 'linkTarget', 'linkVisibility', 'linkCurvature'].map(function (p) {\n  return _defineProperty({}, p, bindBoth.linkProp(p));\n}))));\nvar linkedMethods = Object.assign.apply(Object, _toConsumableArray(['d3Force', 'd3ReheatSimulation', 'emitParticle'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkMethod(p));\n})));\n\nfunction adjustCanvasSize(state) {\n  if (state.canvas) {\n    var curWidth = state.canvas.width;\n    var curHeight = state.canvas.height;\n\n    if (curWidth === 300 && curHeight === 150) {\n      // Default canvas dimensions\n      curWidth = curHeight = 0;\n    }\n\n    var pxScale = window.devicePixelRatio; // 2 on retina displays\n\n    curWidth /= pxScale;\n    curHeight /= pxScale; // Resize canvases\n\n    [state.canvas, state.shadowCanvas].forEach(function (canvas) {\n      // Element size\n      canvas.style.width = \"\".concat(state.width, \"px\");\n      canvas.style.height = \"\".concat(state.height, \"px\"); // Memory size (scaled to avoid blurriness)\n\n      canvas.width = state.width * pxScale;\n      canvas.height = state.height * pxScale; // Normalize coordinate system to use css pixels (on init only)\n\n      if (!curWidth && !curHeight) {\n        canvas.getContext('2d').scale(pxScale, pxScale);\n      }\n    }); // Relative center panning based on 0,0\n\n    var k = zoomTransform(state.canvas).k;\n    state.zoom.translateBy(state.zoom.__baseElem, (state.width - curWidth) / 2 / k, (state.height - curHeight) / 2 / k);\n    state.needsRedraw = true;\n  }\n}\n\nfunction resetTransform(ctx) {\n  var pxRatio = window.devicePixelRatio;\n  ctx.setTransform(pxRatio, 0, 0, pxRatio, 0, 0);\n}\n\nfunction clearCanvas(ctx, width, height) {\n  ctx.save();\n  resetTransform(ctx); // reset transform\n\n  ctx.clearRect(0, 0, width, height);\n  ctx.restore(); //restore transforms\n} //\n\n\nvar forceGraph = Kapsule({\n  props: _objectSpread2({\n    width: {\n      \"default\": window.innerWidth,\n      onChange: function onChange(_, state) {\n        return adjustCanvasSize(state);\n      },\n      triggerUpdate: false\n    },\n    height: {\n      \"default\": window.innerHeight,\n      onChange: function onChange(_, state) {\n        return adjustCanvasSize(state);\n      },\n      triggerUpdate: false\n    },\n    graphData: {\n      \"default\": {\n        nodes: [],\n        links: []\n      },\n      onChange: function onChange(d, state) {\n        [{\n          type: 'Node',\n          objs: d.nodes\n        }, {\n          type: 'Link',\n          objs: d.links\n        }].forEach(hexIndex);\n        state.forceGraph.graphData(d);\n        state.shadowGraph.graphData(d);\n\n        function hexIndex(_ref4) {\n          var type = _ref4.type,\n              objs = _ref4.objs;\n          objs.filter(function (d) {\n            if (!d.hasOwnProperty('__indexColor')) return true;\n            var cur = state.colorTracker.lookup(d.__indexColor);\n            return !cur || !cur.hasOwnProperty('d') || cur.d !== d;\n          }).forEach(function (d) {\n            // store object lookup color\n            d.__indexColor = state.colorTracker.register({\n              type: type,\n              d: d\n            });\n          });\n        }\n      },\n      triggerUpdate: false\n    },\n    backgroundColor: {\n      onChange: function onChange(color, state) {\n        state.canvas && color && (state.canvas.style.background = color);\n      },\n      triggerUpdate: false\n    },\n    nodeLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    nodePointerAreaPaint: {\n      onChange: function onChange(paintFn, state) {\n        state.shadowGraph.nodeCanvasObject(!paintFn ? null : function (node, ctx, globalScale) {\n          return paintFn(node, node.__indexColor, ctx, globalScale);\n        });\n        state.flushShadowCanvas && state.flushShadowCanvas();\n      },\n      triggerUpdate: false\n    },\n    linkPointerAreaPaint: {\n      onChange: function onChange(paintFn, state) {\n        state.shadowGraph.linkCanvasObject(!paintFn ? null : function (link, ctx, globalScale) {\n          return paintFn(link, link.__indexColor, ctx, globalScale);\n        });\n        state.flushShadowCanvas && state.flushShadowCanvas();\n      },\n      triggerUpdate: false\n    },\n    linkLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    linkHoverPrecision: {\n      \"default\": 4,\n      triggerUpdate: false\n    },\n    minZoom: {\n      \"default\": 0.01,\n      onChange: function onChange(minZoom, state) {\n        state.zoom.scaleExtent([minZoom, state.zoom.scaleExtent()[1]]);\n      },\n      triggerUpdate: false\n    },\n    maxZoom: {\n      \"default\": 1000,\n      onChange: function onChange(maxZoom, state) {\n        state.zoom.scaleExtent([state.zoom.scaleExtent()[0], maxZoom]);\n      },\n      triggerUpdate: false\n    },\n    enableNodeDrag: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    enableZoomInteraction: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    enablePanInteraction: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    enableZoomPanInteraction: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    // to be deprecated\n    enablePointerInteraction: {\n      \"default\": true,\n      onChange: function onChange(_, state) {\n        state.hoverObj = null;\n      },\n      triggerUpdate: false\n    },\n    autoPauseRedraw: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    onNodeDrag: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeDragEnd: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeClick: {\n      triggerUpdate: false\n    },\n    onNodeRightClick: {\n      triggerUpdate: false\n    },\n    onNodeHover: {\n      triggerUpdate: false\n    },\n    onLinkClick: {\n      triggerUpdate: false\n    },\n    onLinkRightClick: {\n      triggerUpdate: false\n    },\n    onLinkHover: {\n      triggerUpdate: false\n    },\n    onBackgroundClick: {\n      triggerUpdate: false\n    },\n    onBackgroundRightClick: {\n      triggerUpdate: false\n    },\n    onZoom: {\n      triggerUpdate: false\n    },\n    onZoomEnd: {\n      triggerUpdate: false\n    },\n    onRenderFramePre: {\n      triggerUpdate: false\n    },\n    onRenderFramePost: {\n      triggerUpdate: false\n    }\n  }, linkedProps),\n  aliases: {\n    // Prop names supported for backwards compatibility\n    stopAnimation: 'pauseAnimation'\n  },\n  methods: _objectSpread2({\n    graph2ScreenCoords: function graph2ScreenCoords(state, x, y) {\n      var t = zoomTransform(state.canvas);\n      return {\n        x: x * t.k + t.x,\n        y: y * t.k + t.y\n      };\n    },\n    screen2GraphCoords: function screen2GraphCoords(state, x, y) {\n      var t = zoomTransform(state.canvas);\n      return {\n        x: (x - t.x) / t.k,\n        y: (y - t.y) / t.k\n      };\n    },\n    centerAt: function centerAt(state, x, y, transitionDuration) {\n      if (!state.canvas) return null; // no canvas yet\n      // setter\n\n      if (x !== undefined || y !== undefined) {\n        var finalPos = Object.assign({}, x !== undefined ? {\n          x: x\n        } : {}, y !== undefined ? {\n          y: y\n        } : {});\n\n        if (!transitionDuration) {\n          // no animation\n          setCenter(finalPos);\n        } else {\n          new TWEEN.Tween(getCenter()).to(finalPos, transitionDuration).easing(TWEEN.Easing.Quadratic.Out).onUpdate(setCenter).start();\n        }\n\n        return this;\n      } // getter\n\n\n      return getCenter(); //\n\n      function getCenter() {\n        var t = zoomTransform(state.canvas);\n        return {\n          x: (state.width / 2 - t.x) / t.k,\n          y: (state.height / 2 - t.y) / t.k\n        };\n      }\n\n      function setCenter(_ref5) {\n        var x = _ref5.x,\n            y = _ref5.y;\n        state.zoom.translateTo(state.zoom.__baseElem, x === undefined ? getCenter().x : x, y === undefined ? getCenter().y : y);\n        state.needsRedraw = true;\n      }\n    },\n    zoom: function zoom(state, k, transitionDuration) {\n      if (!state.canvas) return null; // no canvas yet\n      // setter\n\n      if (k !== undefined) {\n        if (!transitionDuration) {\n          // no animation\n          setZoom(k);\n        } else {\n          new TWEEN.Tween({\n            k: getZoom()\n          }).to({\n            k: k\n          }, transitionDuration).easing(TWEEN.Easing.Quadratic.Out).onUpdate(function (_ref6) {\n            var k = _ref6.k;\n            return setZoom(k);\n          }).start();\n        }\n\n        return this;\n      } // getter\n\n\n      return getZoom(); //\n\n      function getZoom() {\n        return zoomTransform(state.canvas).k;\n      }\n\n      function setZoom(k) {\n        state.zoom.scaleTo(state.zoom.__baseElem, k);\n        state.needsRedraw = true;\n      }\n    },\n    zoomToFit: function zoomToFit(state) {\n      var transitionDuration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var padding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 10;\n\n      for (var _len = arguments.length, bboxArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n        bboxArgs[_key - 3] = arguments[_key];\n      }\n\n      var bbox = this.getGraphBbox.apply(this, bboxArgs);\n\n      if (bbox) {\n        var center = {\n          x: (bbox.x[0] + bbox.x[1]) / 2,\n          y: (bbox.y[0] + bbox.y[1]) / 2\n        };\n        var zoomK = Math.max(1e-12, Math.min(1e12, (state.width - padding * 2) / (bbox.x[1] - bbox.x[0]), (state.height - padding * 2) / (bbox.y[1] - bbox.y[0])));\n        this.centerAt(center.x, center.y, transitionDuration);\n        this.zoom(zoomK, transitionDuration);\n      }\n\n      return this;\n    },\n    getGraphBbox: function getGraphBbox(state) {\n      var nodeFilter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {\n        return true;\n      };\n      var getVal = accessorFn(state.nodeVal);\n\n      var getR = function getR(node) {\n        return Math.sqrt(Math.max(0, getVal(node) || 1)) * state.nodeRelSize;\n      };\n\n      var nodesPos = state.graphData.nodes.filter(nodeFilter).map(function (node) {\n        return {\n          x: node.x,\n          y: node.y,\n          r: getR(node)\n        };\n      });\n      return !nodesPos.length ? null : {\n        x: [min(nodesPos, function (node) {\n          return node.x - node.r;\n        }), max(nodesPos, function (node) {\n          return node.x + node.r;\n        })],\n        y: [min(nodesPos, function (node) {\n          return node.y - node.r;\n        }), max(nodesPos, function (node) {\n          return node.y + node.r;\n        })]\n      };\n    },\n    pauseAnimation: function pauseAnimation(state) {\n      if (state.animationFrameRequestId) {\n        cancelAnimationFrame(state.animationFrameRequestId);\n        state.animationFrameRequestId = null;\n      }\n\n      return this;\n    },\n    resumeAnimation: function resumeAnimation(state) {\n      if (!state.animationFrameRequestId) {\n        this._animationCycle();\n      }\n\n      return this;\n    },\n    _destructor: function _destructor() {\n      this.pauseAnimation();\n      this.graphData({\n        nodes: [],\n        links: []\n      });\n    }\n  }, linkedMethods),\n  stateInit: function stateInit() {\n    return {\n      lastSetZoom: 1,\n      zoom: zoom(),\n      forceGraph: new CanvasForceGraph(),\n      shadowGraph: new CanvasForceGraph().cooldownTicks(0).nodeColor('__indexColor').linkColor('__indexColor').isShadow(true),\n      colorTracker: new ColorTracker() // indexed objects for rgb lookup\n\n    };\n  },\n  init: function init(domNode, state) {\n    var _this = this; // Wipe DOM\n\n\n    domNode.innerHTML = ''; // Container anchor for canvas and tooltip\n\n    var container = document.createElement('div');\n    container.classList.add('force-graph-container');\n    container.style.position = 'relative';\n    domNode.appendChild(container);\n    state.canvas = document.createElement('canvas');\n    if (state.backgroundColor) state.canvas.style.background = state.backgroundColor;\n    container.appendChild(state.canvas);\n    state.shadowCanvas = document.createElement('canvas'); // Show shadow canvas\n    //state.shadowCanvas.style.position = 'absolute';\n    //state.shadowCanvas.style.top = '0';\n    //state.shadowCanvas.style.left = '0';\n    //container.appendChild(state.shadowCanvas);\n\n    var ctx = state.canvas.getContext('2d');\n    var shadowCtx = state.shadowCanvas.getContext('2d');\n    var pointerPos = {\n      x: -1e12,\n      y: -1e12\n    };\n\n    var getObjUnderPointer = function getObjUnderPointer() {\n      var obj = null;\n      var pxScale = window.devicePixelRatio;\n      var px = pointerPos.x > 0 && pointerPos.y > 0 ? shadowCtx.getImageData(pointerPos.x * pxScale, pointerPos.y * pxScale, 1, 1) : null; // Lookup object per pixel color\n\n      px && (obj = state.colorTracker.lookup(px.data));\n      return obj;\n    }; // Setup node drag interaction\n\n\n    select(state.canvas).call(drag().subject(function () {\n      if (!state.enableNodeDrag) {\n        return null;\n      }\n\n      var obj = getObjUnderPointer();\n      return obj && obj.type === 'Node' ? obj.d : null; // Only drag nodes\n    }).on('start', function (ev) {\n      var obj = ev.subject;\n      obj.__initialDragPos = {\n        x: obj.x,\n        y: obj.y,\n        fx: obj.fx,\n        fy: obj.fy\n      }; // keep engine running at low intensity throughout drag\n\n      if (!ev.active) {\n        obj.fx = obj.x;\n        obj.fy = obj.y; // Fix points\n      } // drag cursor\n\n\n      state.canvas.classList.add('grabbable');\n    }).on('drag', function (ev) {\n      var obj = ev.subject;\n      var initPos = obj.__initialDragPos;\n      var dragPos = ev;\n      var k = zoomTransform(state.canvas).k;\n      var translate = {\n        x: initPos.x + (dragPos.x - initPos.x) / k - obj.x,\n        y: initPos.y + (dragPos.y - initPos.y) / k - obj.y\n      }; // Move fx/fy (and x/y) of nodes based on the scaled drag distance since the drag start\n\n      ['x', 'y'].forEach(function (c) {\n        return obj[\"f\".concat(c)] = obj[c] = initPos[c] + (dragPos[c] - initPos[c]) / k;\n      }); // prevent freeze while dragging\n\n      state.forceGraph.d3AlphaTarget(0.3) // keep engine running at low intensity throughout drag\n      .resetCountdown(); // prevent freeze while dragging\n\n      state.isPointerDragging = true;\n      obj.__dragged = true;\n      state.onNodeDrag(obj, translate);\n    }).on('end', function (ev) {\n      var obj = ev.subject;\n      var initPos = obj.__initialDragPos;\n      var translate = {\n        x: obj.x - initPos.x,\n        y: obj.y - initPos.y\n      };\n\n      if (initPos.fx === undefined) {\n        obj.fx = undefined;\n      }\n\n      if (initPos.fy === undefined) {\n        obj.fy = undefined;\n      }\n\n      delete obj.__initialDragPos;\n\n      if (state.forceGraph.d3AlphaTarget()) {\n        state.forceGraph.d3AlphaTarget(0) // release engine low intensity\n        .resetCountdown(); // let the engine readjust after releasing fixed nodes\n      } // drag cursor\n\n\n      state.canvas.classList.remove('grabbable');\n      state.isPointerDragging = false;\n\n      if (obj.__dragged) {\n        delete obj.__dragged;\n        state.onNodeDragEnd(obj, translate);\n      }\n    })); // Setup zoom / pan interaction\n\n    state.zoom(state.zoom.__baseElem = select(state.canvas)); // Attach controlling elem for easy access\n\n    state.zoom.__baseElem.on('dblclick.zoom', null); // Disable double-click to zoom\n\n\n    state.zoom.filter(function (ev) {\n      return (// disable zoom interaction\n        !ev.button && state.enableZoomPanInteraction && (state.enableZoomInteraction || ev.type !== 'wheel') && (state.enablePanInteraction || ev.type === 'wheel')\n      );\n    }).on('zoom', function (ev) {\n      var t = ev.transform;\n      [ctx, shadowCtx].forEach(function (c) {\n        resetTransform(c);\n        c.translate(t.x, t.y);\n        c.scale(t.k, t.k);\n      });\n      state.onZoom && state.onZoom(_objectSpread2(_objectSpread2({}, t), _this.centerAt())); // report x,y coordinates relative to canvas center\n\n      state.needsRedraw = true;\n    }).on('end', function (ev) {\n      return state.onZoomEnd && state.onZoomEnd(_objectSpread2(_objectSpread2({}, ev.transform), _this.centerAt()));\n    });\n    adjustCanvasSize(state);\n    state.forceGraph.onNeedsRedraw(function () {\n      return state.needsRedraw = true;\n    }).onFinishUpdate(function () {\n      // re-zoom, if still in default position (not user modified)\n      if (zoomTransform(state.canvas).k === state.lastSetZoom && state.graphData.nodes.length) {\n        state.zoom.scaleTo(state.zoom.__baseElem, state.lastSetZoom = ZOOM2NODES_FACTOR / Math.cbrt(state.graphData.nodes.length));\n        state.needsRedraw = true;\n      }\n    }); // Setup tooltip\n\n    var toolTipElem = document.createElement('div');\n    toolTipElem.classList.add('graph-tooltip');\n    container.appendChild(toolTipElem); // Capture pointer coords on move or touchstart\n\n    ['pointermove', 'pointerdown'].forEach(function (evType) {\n      return container.addEventListener(evType, function (ev) {\n        if (evType === 'pointerdown') {\n          state.isPointerPressed = true; // track click state\n\n          state.pointerDownEvent = ev;\n        } // detect pointer drag on canvas pan\n\n\n        !state.isPointerDragging && ev.type === 'pointermove' && state.onBackgroundClick // only bother detecting drags this way if background clicks are enabled (so they don't trigger accidentally on canvas panning)\n        && (ev.pressure > 0 || state.isPointerPressed) // ev.pressure always 0 on Safari, so we use the isPointerPressed tracker\n        && (ev.pointerType !== 'touch' || ev.movementX === undefined || [ev.movementX, ev.movementY].some(function (m) {\n          return Math.abs(m) > 1;\n        })) // relax drag trigger sensitivity on touch events\n        && (state.isPointerDragging = true); // update the pointer pos\n\n        var offset = getOffset(container);\n        pointerPos.x = ev.pageX - offset.left;\n        pointerPos.y = ev.pageY - offset.top; // Move tooltip\n\n        toolTipElem.style.top = \"\".concat(pointerPos.y, \"px\");\n        toolTipElem.style.left = \"\".concat(pointerPos.x, \"px\"); //\n\n        function getOffset(el) {\n          var rect = el.getBoundingClientRect(),\n              scrollLeft = window.pageXOffset || document.documentElement.scrollLeft,\n              scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n          return {\n            top: rect.top + scrollTop,\n            left: rect.left + scrollLeft\n          };\n        }\n      }, {\n        passive: true\n      });\n    }); // Handle click/touch events on nodes/links\n\n    container.addEventListener('pointerup', function (ev) {\n      state.isPointerPressed = false;\n\n      if (state.isPointerDragging) {\n        state.isPointerDragging = false;\n        return; // don't trigger click events after pointer drag (pan / node drag functionality)\n      }\n\n      var cbEvents = [ev, state.pointerDownEvent];\n      requestAnimationFrame(function () {\n        // trigger click events asynchronously, to allow hoverObj to be set (on frame)\n        if (ev.button === 0) {\n          // mouse left-click or touch\n          if (state.hoverObj) {\n            var fn = state[\"on\".concat(state.hoverObj.type, \"Click\")];\n            fn && fn.apply(void 0, [state.hoverObj.d].concat(cbEvents));\n          } else {\n            state.onBackgroundClick && state.onBackgroundClick.apply(state, cbEvents);\n          }\n        }\n\n        if (ev.button === 2) {\n          // mouse right-click\n          if (state.hoverObj) {\n            var _fn = state[\"on\".concat(state.hoverObj.type, \"RightClick\")];\n            _fn && _fn.apply(void 0, [state.hoverObj.d].concat(cbEvents));\n          } else {\n            state.onBackgroundRightClick && state.onBackgroundRightClick.apply(state, cbEvents);\n          }\n        }\n      });\n    }, {\n      passive: true\n    });\n    container.addEventListener('contextmenu', function (ev) {\n      if (!state.onBackgroundRightClick && !state.onNodeRightClick && !state.onLinkRightClick) return true; // default contextmenu behavior\n\n      ev.preventDefault();\n      return false;\n    });\n    state.forceGraph(ctx);\n    state.shadowGraph(shadowCtx); //\n\n    var refreshShadowCanvas = throttle(function () {\n      // wipe canvas\n      clearCanvas(shadowCtx, state.width, state.height); // Adjust link hover area\n\n      state.shadowGraph.linkWidth(function (l) {\n        return accessorFn(state.linkWidth)(l) + state.linkHoverPrecision;\n      }); // redraw\n\n      var t = zoomTransform(state.canvas);\n      state.shadowGraph.globalScale(t.k).tickFrame();\n    }, HOVER_CANVAS_THROTTLE_DELAY);\n    state.flushShadowCanvas = refreshShadowCanvas.flush; // hook to immediately invoke shadow canvas paint\n    // Kick-off renderer\n\n    (this._animationCycle = function animate() {\n      // IIFE\n      var doRedraw = !state.autoPauseRedraw || !!state.needsRedraw || state.forceGraph.isEngineRunning() || state.graphData.links.some(function (d) {\n        return d.__photons && d.__photons.length;\n      });\n      state.needsRedraw = false;\n\n      if (state.enablePointerInteraction) {\n        // Update tooltip and trigger onHover events\n        var obj = !state.isPointerDragging ? getObjUnderPointer() : null; // don't hover during drag\n\n        if (obj !== state.hoverObj) {\n          var prevObj = state.hoverObj;\n          var prevObjType = prevObj ? prevObj.type : null;\n          var objType = obj ? obj.type : null;\n\n          if (prevObjType && prevObjType !== objType) {\n            // Hover out\n            var fn = state[\"on\".concat(prevObjType, \"Hover\")];\n            fn && fn(null, prevObj.d);\n          }\n\n          if (objType) {\n            // Hover in\n            var _fn2 = state[\"on\".concat(objType, \"Hover\")];\n            _fn2 && _fn2(obj.d, prevObjType === objType ? prevObj.d : null);\n          }\n\n          var tooltipContent = obj ? accessorFn(state[\"\".concat(obj.type.toLowerCase(), \"Label\")])(obj.d) || '' : '';\n          toolTipElem.style.visibility = tooltipContent ? 'visible' : 'hidden';\n          toolTipElem.innerHTML = tooltipContent; // set pointer if hovered object is clickable\n\n          state.canvas.classList[obj && state[\"on\".concat(objType, \"Click\")] || !obj && state.onBackgroundClick ? 'add' : 'remove']('clickable');\n          state.hoverObj = obj;\n        }\n\n        doRedraw && refreshShadowCanvas();\n      }\n\n      if (doRedraw) {\n        // Wipe canvas\n        clearCanvas(ctx, state.width, state.height); // Frame cycle\n\n        var globalScale = zoomTransform(state.canvas).k;\n        state.onRenderFramePre && state.onRenderFramePre(ctx, globalScale);\n        state.forceGraph.globalScale(globalScale).tickFrame();\n        state.onRenderFramePost && state.onRenderFramePost(ctx, globalScale);\n      }\n\n      TWEEN.update(); // update canvas animation tweens\n\n      state.animationFrameRequestId = requestAnimationFrame(animate);\n    })();\n  },\n  update: function updateFn(state) {}\n});\nexport { forceGraph as default };","map":{"version":3,"names":["select","zoomTransform","zoom","drag","min","max","throttle","TWEEN","Kapsule","accessorFn","ColorTracker","forceSimulation","forceLink","forceManyBody","forceCenter","forceRadial","Bezier","indexBy","scaleOrdinal","schemePaired","styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","css_248z","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_typeof","obj","Symbol","iterator","constructor","prototype","value","configurable","writable","_setPrototypeOf","o","p","setPrototypeOf","bind","__proto__","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","call","e","_construct","Parent","args","Class","a","Constructor","Function","instance","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","Array","isArray","_arrayLikeToArray","iter","from","_i","_arr","_n","_d","_s","_e","next","done","err","minLen","n","toString","slice","name","test","len","arr2","TypeError","autoColorScale","autoColorObjects","objects","colorByAccessor","colorField","getDagDepths","_ref","idAccessor","nodes","links","_ref2","undefined","_ref2$nodeFilter","nodeFilter","_ref2$onLoopError","onLoopError","loopIds","concat","join","graph","node","data","out","depth","skip","_ref3","sourceId","getNodeId","targetId","hasOwnProperty","sourceNode","targetNode","foundLoops","traverse","values","nodeDepths","assign","entries","_ref4","_ref5","map","_ref6","_ref7","id","nodeStack","currentDepth","l","indexOf","_ret","loop","d","some","foundLoop","every","idx","DAG_LEVEL_NODE_RATIO","notifyRedraw","_","state","onNeedsRedraw","CanvasForceGraph","props","graphData","onChange","engineRunning","dagMode","fx","fy","dagLevelDistance","dagNodeFilter","_default","onDagError","triggerUpdate","nodeRelSize","nodeId","nodeVal","nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","nodeVisibility","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCurvature","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","globalScale","d3AlphaMin","d3AlphaDecay","alphaDecay","forceLayout","d3AlphaTarget","alphaTarget","d3VelocityDecay","velocityDecay","warmupTicks","cooldownTicks","Infinity","cooldownTime","onUpdate","onFinishUpdate","onEngineTick","onEngineStop","isShadow","methods","d3Force","forceName","forceFn","force","d3ReheatSimulation","alpha","resetCountdown","cntTicks","startTickTime","Date","isEngineRunning","tickFrame","layoutTick","paintLinks","paintArrows","paintPhotons","paintNodes","tick","getVisibility","getVal","getColor","getNodeCanvasObjectMode","ctx","padAmount","visibleNodes","save","restore","r","Math","sqrt","beginPath","arc","x","y","PI","fillStyle","fill","getWidth","getLineDash","getCurvature","getLinkCanvasObjectMode","visibleLinks","calcLinkControlPoints","beforeCustomLinks","afterCustomLinks","defaultPaintLinks","replaceCustomLinks","otherCustomLinks","before","after","replace","link","linksPerColor","color","linksPerWidth","lineColor","width","linesPerLineDash","lineWidth","lineDashSegments","start","end","moveTo","controlPoints","__controlPoints","lineTo","strokeStyle","setLineDash","stroke","curvature","pow","atan2","cp","cos","sin","ARROW_WH_RATIO","ARROW_VLEN_RATIO","getLength","getRelPos","getNodeVal","arrowLength","startR","endR","arrowRelPos","arrowColor","arrowHalfWidth","bzLine","getCoordsAlongLine","t","get","lineLen","posAlongLine","arrowHead","arrowTail","arrowTailVertex","arrowTailAngle","getNumPhotons","getSpeed","getDiameter","numCyclePhotons","__photons","particleSpeed","photons","photonR","photonColor","cyclePhotonIdx","needsCleanup","photon","singleHop","__singleHop","__progressRatio","photonPosRatio","coords","emitParticle","stateInit","stop","init","canvasCtx","update","linkParticlesAccessor","numPhotons","round","abs","linkForce","maxDepth","getFFn","fix","invert","fxFn","fyFn","nodeDepth","strength","linkKapsule","kapsulePropNames","kapsuleType","propNames","dummyK","linkProp","prop","v","propName","linkMethod","method","_len","_key","returnVals","kapsuleInstance","returnVal","HOVER_CANVAS_THROTTLE_DELAY","ZOOM2NODES_FACTOR","bindFG","bindBoth","linkedProps","linkedMethods","adjustCanvasSize","canvas","curWidth","curHeight","height","pxScale","window","devicePixelRatio","shadowCanvas","getContext","scale","k","translateBy","__baseElem","needsRedraw","resetTransform","pxRatio","setTransform","clearCanvas","clearRect","forceGraph","innerWidth","innerHeight","objs","hexIndex","shadowGraph","cur","colorTracker","lookup","__indexColor","register","backgroundColor","background","nodeLabel","nodePointerAreaPaint","paintFn","flushShadowCanvas","linkPointerAreaPaint","linkLabel","linkHoverPrecision","minZoom","scaleExtent","maxZoom","enableNodeDrag","enableZoomInteraction","enablePanInteraction","enableZoomPanInteraction","enablePointerInteraction","hoverObj","autoPauseRedraw","onNodeDrag","onNodeDragEnd","onNodeClick","onNodeRightClick","onNodeHover","onLinkClick","onLinkRightClick","onLinkHover","onBackgroundClick","onBackgroundRightClick","onZoom","onZoomEnd","onRenderFramePre","onRenderFramePost","aliases","stopAnimation","graph2ScreenCoords","screen2GraphCoords","centerAt","transitionDuration","finalPos","setCenter","Tween","getCenter","to","easing","Easing","Quadratic","Out","translateTo","setZoom","getZoom","scaleTo","zoomToFit","padding","bboxArgs","bbox","getGraphBbox","center","zoomK","getR","nodesPos","pauseAnimation","animationFrameRequestId","cancelAnimationFrame","resumeAnimation","_animationCycle","_destructor","lastSetZoom","domNode","_this","innerHTML","container","classList","add","position","shadowCtx","pointerPos","getObjUnderPointer","px","getImageData","subject","on","ev","__initialDragPos","active","initPos","dragPos","translate","c","isPointerDragging","__dragged","remove","button","transform","cbrt","toolTipElem","evType","addEventListener","isPointerPressed","pointerDownEvent","pressure","pointerType","movementX","movementY","m","offset","getOffset","pageX","left","pageY","top","el","rect","getBoundingClientRect","scrollLeft","pageXOffset","documentElement","scrollTop","pageYOffset","passive","cbEvents","requestAnimationFrame","fn","_fn","preventDefault","refreshShadowCanvas","flush","animate","doRedraw","prevObj","prevObjType","objType","_fn2","tooltipContent","toLowerCase","visibility","updateFn","default"],"sources":["/Users/zack/src/_-MUSC/gene-graph-MUSC/node_modules/force-graph/dist/force-graph.module.js"],"sourcesContent":["import { select } from 'd3-selection';\nimport { zoomTransform, zoom } from 'd3-zoom';\nimport { drag } from 'd3-drag';\nimport { min, max } from 'd3-array';\nimport throttle from 'lodash.throttle';\nimport TWEEN from '@tweenjs/tween.js';\nimport Kapsule from 'kapsule';\nimport accessorFn from 'accessor-fn';\nimport ColorTracker from 'canvas-color-tracker';\nimport { forceSimulation, forceLink, forceManyBody, forceCenter, forceRadial } from 'd3-force-3d';\nimport { Bezier } from 'bezier-js';\nimport indexBy from 'index-array-by';\nimport { scaleOrdinal } from 'd3-scale';\nimport { schemePaired } from 'd3-scale-chromatic';\n\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".force-graph-container canvas {\\n  display: block;\\n  user-select: none;\\n  outline: none;\\n  -webkit-tap-highlight-color: transparent;\\n}\\n\\n.force-graph-container .graph-tooltip {\\n  position: absolute;\\n  top: 0;\\n  transform: translate(-50%, 25px);\\n  font-family: sans-serif;\\n  font-size: 16px;\\n  padding: 4px;\\n  border-radius: 3px;\\n  color: #eee;\\n  background: rgba(0,0,0,0.65);\\n  visibility: hidden; /* by default */\\n}\\n\\n.force-graph-container .clickable {\\n  cursor: pointer;\\n}\\n\\n.force-graph-container .grabbable {\\n  cursor: move;\\n  cursor: grab;\\n  cursor: -moz-grab;\\n  cursor: -webkit-grab;\\n}\\n\\n.force-graph-container .grabbable:active {\\n  cursor: grabbing;\\n  cursor: -moz-grabbing;\\n  cursor: -webkit-grabbing;\\n}\\n\";\nstyleInject(css_248z);\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _construct(Parent, args, Class) {\n  if (_isNativeReflectConstruct()) {\n    _construct = Reflect.construct.bind();\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) _setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar autoColorScale = scaleOrdinal(schemePaired); // Autoset attribute colorField by colorByAccessor property\n// If an object has already a color, don't set it\n// Objects can be nodes or links\n\nfunction autoColorObjects(objects, colorByAccessor, colorField) {\n  if (!colorByAccessor || typeof colorField !== 'string') return;\n  objects.filter(function (obj) {\n    return !obj[colorField];\n  }).forEach(function (obj) {\n    obj[colorField] = autoColorScale(colorByAccessor(obj));\n  });\n}\n\nfunction getDagDepths (_ref, idAccessor) {\n  var nodes = _ref.nodes,\n      links = _ref.links;\n\n  var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      _ref2$nodeFilter = _ref2.nodeFilter,\n      nodeFilter = _ref2$nodeFilter === void 0 ? function () {\n    return true;\n  } : _ref2$nodeFilter,\n      _ref2$onLoopError = _ref2.onLoopError,\n      onLoopError = _ref2$onLoopError === void 0 ? function (loopIds) {\n    throw \"Invalid DAG structure! Found cycle in node path: \".concat(loopIds.join(' -> '), \".\");\n  } : _ref2$onLoopError;\n\n  // linked graph\n  var graph = {};\n  nodes.forEach(function (node) {\n    return graph[idAccessor(node)] = {\n      data: node,\n      out: [],\n      depth: -1,\n      skip: !nodeFilter(node)\n    };\n  });\n  links.forEach(function (_ref3) {\n    var source = _ref3.source,\n        target = _ref3.target;\n    var sourceId = getNodeId(source);\n    var targetId = getNodeId(target);\n    if (!graph.hasOwnProperty(sourceId)) throw \"Missing source node with id: \".concat(sourceId);\n    if (!graph.hasOwnProperty(targetId)) throw \"Missing target node with id: \".concat(targetId);\n    var sourceNode = graph[sourceId];\n    var targetNode = graph[targetId];\n    sourceNode.out.push(targetNode);\n\n    function getNodeId(node) {\n      return _typeof(node) === 'object' ? idAccessor(node) : node;\n    }\n  });\n  var foundLoops = [];\n  traverse(Object.values(graph));\n  var nodeDepths = Object.assign.apply(Object, [{}].concat(_toConsumableArray(Object.entries(graph).filter(function (_ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n        node = _ref5[1];\n\n    return !node.skip;\n  }).map(function (_ref6) {\n    var _ref7 = _slicedToArray(_ref6, 2),\n        id = _ref7[0],\n        node = _ref7[1];\n\n    return _defineProperty({}, id, node.depth);\n  }))));\n  return nodeDepths;\n\n  function traverse(nodes) {\n    var nodeStack = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var currentDepth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n    for (var i = 0, l = nodes.length; i < l; i++) {\n      var node = nodes[i];\n\n      if (nodeStack.indexOf(node) !== -1) {\n        var _ret = function () {\n          var loop = [].concat(_toConsumableArray(nodeStack.slice(nodeStack.indexOf(node))), [node]).map(function (d) {\n            return idAccessor(d.data);\n          });\n\n          if (!foundLoops.some(function (foundLoop) {\n            return foundLoop.length === loop.length && foundLoop.every(function (id, idx) {\n              return id === loop[idx];\n            });\n          })) {\n            foundLoops.push(loop);\n            onLoopError(loop);\n          }\n\n          return \"continue\";\n        }();\n\n        if (_ret === \"continue\") continue;\n      }\n\n      if (currentDepth > node.depth) {\n        // Don't unnecessarily revisit chunks of the graph\n        node.depth = currentDepth;\n        traverse(node.out, [].concat(_toConsumableArray(nodeStack), [node]), currentDepth + (node.skip ? 0 : 1));\n      }\n    }\n  }\n}\n\nvar DAG_LEVEL_NODE_RATIO = 2; // whenever styling props are changed that require a canvas redraw\n\nvar notifyRedraw = function notifyRedraw(_, state) {\n  return state.onNeedsRedraw && state.onNeedsRedraw();\n};\n\nvar CanvasForceGraph = Kapsule({\n  props: {\n    graphData: {\n      \"default\": {\n        nodes: [],\n        links: []\n      },\n      onChange: function onChange(_, state) {\n        state.engineRunning = false;\n      } // Pause simulation\n\n    },\n    dagMode: {\n      onChange: function onChange(dagMode, state) {\n        // td, bu, lr, rl, radialin, radialout\n        !dagMode && (state.graphData.nodes || []).forEach(function (n) {\n          return n.fx = n.fy = undefined;\n        }); // unfix nodes when disabling dag mode\n      }\n    },\n    dagLevelDistance: {},\n    dagNodeFilter: {\n      \"default\": function _default(node) {\n        return true;\n      }\n    },\n    onDagError: {\n      triggerUpdate: false\n    },\n    nodeRelSize: {\n      \"default\": 4,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    // area per val unit\n    nodeId: {\n      \"default\": 'id'\n    },\n    nodeVal: {\n      \"default\": 'val',\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeColor: {\n      \"default\": 'color',\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeAutoColorBy: {},\n    nodeCanvasObject: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeCanvasObjectMode: {\n      \"default\": function _default() {\n        return 'replace';\n      },\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    nodeVisibility: {\n      \"default\": true,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkSource: {\n      \"default\": 'source'\n    },\n    linkTarget: {\n      \"default\": 'target'\n    },\n    linkVisibility: {\n      \"default\": true,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkColor: {\n      \"default\": 'color',\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkAutoColorBy: {},\n    linkLineDash: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkWidth: {\n      \"default\": 1,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkCurvature: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkCanvasObject: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkCanvasObjectMode: {\n      \"default\": function _default() {\n        return 'replace';\n      },\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkDirectionalArrowLength: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkDirectionalArrowColor: {\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    linkDirectionalArrowRelPos: {\n      \"default\": 0.5,\n      triggerUpdate: false,\n      onChange: notifyRedraw\n    },\n    // value between 0<>1 indicating the relative pos along the (exposed) line\n    linkDirectionalParticles: {\n      \"default\": 0\n    },\n    // animate photons travelling in the link direction\n    linkDirectionalParticleSpeed: {\n      \"default\": 0.01,\n      triggerUpdate: false\n    },\n    // in link length ratio per frame\n    linkDirectionalParticleWidth: {\n      \"default\": 4,\n      triggerUpdate: false\n    },\n    linkDirectionalParticleColor: {\n      triggerUpdate: false\n    },\n    globalScale: {\n      \"default\": 1,\n      triggerUpdate: false\n    },\n    d3AlphaMin: {\n      \"default\": 0,\n      triggerUpdate: false\n    },\n    d3AlphaDecay: {\n      \"default\": 0.0228,\n      triggerUpdate: false,\n      onChange: function onChange(alphaDecay, state) {\n        state.forceLayout.alphaDecay(alphaDecay);\n      }\n    },\n    d3AlphaTarget: {\n      \"default\": 0,\n      triggerUpdate: false,\n      onChange: function onChange(alphaTarget, state) {\n        state.forceLayout.alphaTarget(alphaTarget);\n      }\n    },\n    d3VelocityDecay: {\n      \"default\": 0.4,\n      triggerUpdate: false,\n      onChange: function onChange(velocityDecay, state) {\n        state.forceLayout.velocityDecay(velocityDecay);\n      }\n    },\n    warmupTicks: {\n      \"default\": 0,\n      triggerUpdate: false\n    },\n    // how many times to tick the force engine at init before starting to render\n    cooldownTicks: {\n      \"default\": Infinity,\n      triggerUpdate: false\n    },\n    cooldownTime: {\n      \"default\": 15000,\n      triggerUpdate: false\n    },\n    // ms\n    onUpdate: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onFinishUpdate: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onEngineTick: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onEngineStop: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNeedsRedraw: {\n      triggerUpdate: false\n    },\n    isShadow: {\n      \"default\": false,\n      triggerUpdate: false\n    }\n  },\n  methods: {\n    // Expose d3 forces for external manipulation\n    d3Force: function d3Force(state, forceName, forceFn) {\n      if (forceFn === undefined) {\n        return state.forceLayout.force(forceName); // Force getter\n      }\n\n      state.forceLayout.force(forceName, forceFn); // Force setter\n\n      return this;\n    },\n    d3ReheatSimulation: function d3ReheatSimulation(state) {\n      state.forceLayout.alpha(1);\n      this.resetCountdown();\n      return this;\n    },\n    // reset cooldown state\n    resetCountdown: function resetCountdown(state) {\n      state.cntTicks = 0;\n      state.startTickTime = new Date();\n      state.engineRunning = true;\n      return this;\n    },\n    isEngineRunning: function isEngineRunning(state) {\n      return !!state.engineRunning;\n    },\n    tickFrame: function tickFrame(state) {\n      !state.isShadow && layoutTick();\n      paintLinks();\n      !state.isShadow && paintArrows();\n      !state.isShadow && paintPhotons();\n      paintNodes();\n      return this; //\n\n      function layoutTick() {\n        if (state.engineRunning) {\n          if (++state.cntTicks > state.cooldownTicks || new Date() - state.startTickTime > state.cooldownTime || state.d3AlphaMin > 0 && state.forceLayout.alpha() < state.d3AlphaMin) {\n            state.engineRunning = false; // Stop ticking graph\n\n            state.onEngineStop();\n          } else {\n            state.forceLayout.tick(); // Tick it\n\n            state.onEngineTick();\n          }\n        }\n      }\n\n      function paintNodes() {\n        var getVisibility = accessorFn(state.nodeVisibility);\n        var getVal = accessorFn(state.nodeVal);\n        var getColor = accessorFn(state.nodeColor);\n        var getNodeCanvasObjectMode = accessorFn(state.nodeCanvasObjectMode);\n        var ctx = state.ctx; // Draw wider nodes by 1px on shadow canvas for more precise hovering (due to boundary anti-aliasing)\n\n        var padAmount = state.isShadow / state.globalScale;\n        var visibleNodes = state.graphData.nodes.filter(getVisibility);\n        ctx.save();\n        visibleNodes.forEach(function (node) {\n          var nodeCanvasObjectMode = getNodeCanvasObjectMode(node);\n\n          if (state.nodeCanvasObject && (nodeCanvasObjectMode === 'before' || nodeCanvasObjectMode === 'replace')) {\n            // Custom node before/replace paint\n            state.nodeCanvasObject(node, ctx, state.globalScale);\n\n            if (nodeCanvasObjectMode === 'replace') {\n              ctx.restore();\n              return;\n            }\n          } // Draw wider nodes by 1px on shadow canvas for more precise hovering (due to boundary anti-aliasing)\n\n\n          var r = Math.sqrt(Math.max(0, getVal(node) || 1)) * state.nodeRelSize + padAmount;\n          ctx.beginPath();\n          ctx.arc(node.x, node.y, r, 0, 2 * Math.PI, false);\n          ctx.fillStyle = getColor(node) || 'rgba(31, 120, 180, 0.92)';\n          ctx.fill();\n\n          if (state.nodeCanvasObject && nodeCanvasObjectMode === 'after') {\n            // Custom node after paint\n            state.nodeCanvasObject(node, state.ctx, state.globalScale);\n          }\n        });\n        ctx.restore();\n      }\n\n      function paintLinks() {\n        var getVisibility = accessorFn(state.linkVisibility);\n        var getColor = accessorFn(state.linkColor);\n        var getWidth = accessorFn(state.linkWidth);\n        var getLineDash = accessorFn(state.linkLineDash);\n        var getCurvature = accessorFn(state.linkCurvature);\n        var getLinkCanvasObjectMode = accessorFn(state.linkCanvasObjectMode);\n        var ctx = state.ctx; // Draw wider lines by 2px on shadow canvas for more precise hovering (due to boundary anti-aliasing)\n\n        var padAmount = state.isShadow * 2;\n        var visibleLinks = state.graphData.links.filter(getVisibility);\n        visibleLinks.forEach(calcLinkControlPoints); // calculate curvature control points for all visible links\n\n        var beforeCustomLinks = [],\n            afterCustomLinks = [],\n            defaultPaintLinks = visibleLinks;\n\n        if (state.linkCanvasObject) {\n          var replaceCustomLinks = [],\n              otherCustomLinks = [];\n          visibleLinks.forEach(function (d) {\n            return ({\n              before: beforeCustomLinks,\n              after: afterCustomLinks,\n              replace: replaceCustomLinks\n            }[getLinkCanvasObjectMode(d)] || otherCustomLinks).push(d);\n          });\n          defaultPaintLinks = [].concat(_toConsumableArray(beforeCustomLinks), afterCustomLinks, otherCustomLinks);\n          beforeCustomLinks = beforeCustomLinks.concat(replaceCustomLinks);\n        } // Custom link before paints\n\n\n        ctx.save();\n        beforeCustomLinks.forEach(function (link) {\n          return state.linkCanvasObject(link, ctx, state.globalScale);\n        });\n        ctx.restore(); // Bundle strokes per unique color/width/dash for performance optimization\n\n        var linksPerColor = indexBy(defaultPaintLinks, [getColor, getWidth, getLineDash]);\n        ctx.save();\n        Object.entries(linksPerColor).forEach(function (_ref) {\n          var _ref2 = _slicedToArray(_ref, 2),\n              color = _ref2[0],\n              linksPerWidth = _ref2[1];\n\n          var lineColor = !color || color === 'undefined' ? 'rgba(0,0,0,0.15)' : color;\n          Object.entries(linksPerWidth).forEach(function (_ref3) {\n            var _ref4 = _slicedToArray(_ref3, 2),\n                width = _ref4[0],\n                linesPerLineDash = _ref4[1];\n\n            var lineWidth = (width || 1) / state.globalScale + padAmount;\n            Object.entries(linesPerLineDash).forEach(function (_ref5) {\n              var _ref6 = _slicedToArray(_ref5, 2);\n                  _ref6[0];\n                  var links = _ref6[1];\n\n              var lineDashSegments = getLineDash(links[0]);\n              ctx.beginPath();\n              links.forEach(function (link) {\n                var start = link.source;\n                var end = link.target;\n                if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n                ctx.moveTo(start.x, start.y);\n                var controlPoints = link.__controlPoints;\n\n                if (!controlPoints) {\n                  // Straight line\n                  ctx.lineTo(end.x, end.y);\n                } else {\n                  // Use quadratic curves for regular lines and bezier for loops\n                  ctx[controlPoints.length === 2 ? 'quadraticCurveTo' : 'bezierCurveTo'].apply(ctx, _toConsumableArray(controlPoints).concat([end.x, end.y]));\n                }\n              });\n              ctx.strokeStyle = lineColor;\n              ctx.lineWidth = lineWidth;\n              ctx.setLineDash(lineDashSegments || []);\n              ctx.stroke();\n            });\n          });\n        });\n        ctx.restore(); // Custom link after paints\n\n        ctx.save();\n        afterCustomLinks.forEach(function (link) {\n          return state.linkCanvasObject(link, ctx, state.globalScale);\n        });\n        ctx.restore(); //\n\n        function calcLinkControlPoints(link) {\n          var curvature = getCurvature(link);\n\n          if (!curvature) {\n            // straight line\n            link.__controlPoints = null;\n            return;\n          }\n\n          var start = link.source;\n          var end = link.target;\n          if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n          var l = Math.sqrt(Math.pow(end.x - start.x, 2) + Math.pow(end.y - start.y, 2)); // line length\n\n          if (l > 0) {\n            var a = Math.atan2(end.y - start.y, end.x - start.x); // line angle\n\n            var d = l * curvature; // control point distance\n\n            var cp = {\n              // control point\n              x: (start.x + end.x) / 2 + d * Math.cos(a - Math.PI / 2),\n              y: (start.y + end.y) / 2 + d * Math.sin(a - Math.PI / 2)\n            };\n            link.__controlPoints = [cp.x, cp.y];\n          } else {\n            // Same point, draw a loop\n            var _d = curvature * 70;\n\n            link.__controlPoints = [end.x, end.y - _d, end.x + _d, end.y];\n          }\n        }\n      }\n\n      function paintArrows() {\n        var ARROW_WH_RATIO = 1.6;\n        var ARROW_VLEN_RATIO = 0.2;\n        var getLength = accessorFn(state.linkDirectionalArrowLength);\n        var getRelPos = accessorFn(state.linkDirectionalArrowRelPos);\n        var getVisibility = accessorFn(state.linkVisibility);\n        var getColor = accessorFn(state.linkDirectionalArrowColor || state.linkColor);\n        var getNodeVal = accessorFn(state.nodeVal);\n        var ctx = state.ctx;\n        ctx.save();\n        state.graphData.links.filter(getVisibility).forEach(function (link) {\n          var arrowLength = getLength(link);\n          if (!arrowLength || arrowLength < 0) return;\n          var start = link.source;\n          var end = link.target;\n          if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n          var startR = Math.sqrt(Math.max(0, getNodeVal(start) || 1)) * state.nodeRelSize;\n          var endR = Math.sqrt(Math.max(0, getNodeVal(end) || 1)) * state.nodeRelSize;\n          var arrowRelPos = Math.min(1, Math.max(0, getRelPos(link)));\n          var arrowColor = getColor(link) || 'rgba(0,0,0,0.28)';\n          var arrowHalfWidth = arrowLength / ARROW_WH_RATIO / 2; // Construct bezier for curved lines\n\n          var bzLine = link.__controlPoints && _construct(Bezier, [start.x, start.y].concat(_toConsumableArray(link.__controlPoints), [end.x, end.y]));\n\n          var getCoordsAlongLine = bzLine ? function (t) {\n            return bzLine.get(t);\n          } // get position along bezier line\n          : function (t) {\n            return {\n              // straight line: interpolate linearly\n              x: start.x + (end.x - start.x) * t || 0,\n              y: start.y + (end.y - start.y) * t || 0\n            };\n          };\n          var lineLen = bzLine ? bzLine.length() : Math.sqrt(Math.pow(end.x - start.x, 2) + Math.pow(end.y - start.y, 2));\n          var posAlongLine = startR + arrowLength + (lineLen - startR - endR - arrowLength) * arrowRelPos;\n          var arrowHead = getCoordsAlongLine(posAlongLine / lineLen);\n          var arrowTail = getCoordsAlongLine((posAlongLine - arrowLength) / lineLen);\n          var arrowTailVertex = getCoordsAlongLine((posAlongLine - arrowLength * (1 - ARROW_VLEN_RATIO)) / lineLen);\n          var arrowTailAngle = Math.atan2(arrowHead.y - arrowTail.y, arrowHead.x - arrowTail.x) - Math.PI / 2;\n          ctx.beginPath();\n          ctx.moveTo(arrowHead.x, arrowHead.y);\n          ctx.lineTo(arrowTail.x + arrowHalfWidth * Math.cos(arrowTailAngle), arrowTail.y + arrowHalfWidth * Math.sin(arrowTailAngle));\n          ctx.lineTo(arrowTailVertex.x, arrowTailVertex.y);\n          ctx.lineTo(arrowTail.x - arrowHalfWidth * Math.cos(arrowTailAngle), arrowTail.y - arrowHalfWidth * Math.sin(arrowTailAngle));\n          ctx.fillStyle = arrowColor;\n          ctx.fill();\n        });\n        ctx.restore();\n      }\n\n      function paintPhotons() {\n        var getNumPhotons = accessorFn(state.linkDirectionalParticles);\n        var getSpeed = accessorFn(state.linkDirectionalParticleSpeed);\n        var getDiameter = accessorFn(state.linkDirectionalParticleWidth);\n        var getVisibility = accessorFn(state.linkVisibility);\n        var getColor = accessorFn(state.linkDirectionalParticleColor || state.linkColor);\n        var ctx = state.ctx;\n        ctx.save();\n        state.graphData.links.filter(getVisibility).forEach(function (link) {\n          var numCyclePhotons = getNumPhotons(link);\n          if (!link.hasOwnProperty('__photons') || !link.__photons.length) return;\n          var start = link.source;\n          var end = link.target;\n          if (!start || !end || !start.hasOwnProperty('x') || !end.hasOwnProperty('x')) return; // skip invalid link\n\n          var particleSpeed = getSpeed(link);\n          var photons = link.__photons || [];\n          var photonR = Math.max(0, getDiameter(link) / 2) / Math.sqrt(state.globalScale);\n          var photonColor = getColor(link) || 'rgba(0,0,0,0.28)';\n          ctx.fillStyle = photonColor; // Construct bezier for curved lines\n\n          var bzLine = link.__controlPoints ? _construct(Bezier, [start.x, start.y].concat(_toConsumableArray(link.__controlPoints), [end.x, end.y])) : null;\n          var cyclePhotonIdx = 0;\n          var needsCleanup = false; // whether some photons need to be removed from list\n\n          photons.forEach(function (photon) {\n            var singleHop = !!photon.__singleHop;\n\n            if (!photon.hasOwnProperty('__progressRatio')) {\n              photon.__progressRatio = singleHop ? 0 : cyclePhotonIdx / numCyclePhotons;\n            }\n\n            !singleHop && cyclePhotonIdx++; // increase regular photon index\n\n            photon.__progressRatio += particleSpeed;\n\n            if (photon.__progressRatio >= 1) {\n              if (!singleHop) {\n                photon.__progressRatio = photon.__progressRatio % 1;\n              } else {\n                needsCleanup = true;\n                return;\n              }\n            }\n\n            var photonPosRatio = photon.__progressRatio;\n            var coords = bzLine ? bzLine.get(photonPosRatio) // get position along bezier line\n            : {\n              // straight line: interpolate linearly\n              x: start.x + (end.x - start.x) * photonPosRatio || 0,\n              y: start.y + (end.y - start.y) * photonPosRatio || 0\n            };\n            ctx.beginPath();\n            ctx.arc(coords.x, coords.y, photonR, 0, 2 * Math.PI, false);\n            ctx.fill();\n          });\n\n          if (needsCleanup) {\n            // remove expired single hop photons\n            link.__photons = link.__photons.filter(function (photon) {\n              return !photon.__singleHop || photon.__progressRatio <= 1;\n            });\n          }\n        });\n        ctx.restore();\n      }\n    },\n    emitParticle: function emitParticle(state, link) {\n      if (link) {\n        !link.__photons && (link.__photons = []);\n\n        link.__photons.push({\n          __singleHop: true\n        }); // add a single hop particle\n\n      }\n\n      return this;\n    }\n  },\n  stateInit: function stateInit() {\n    return {\n      forceLayout: forceSimulation().force('link', forceLink()).force('charge', forceManyBody()).force('center', forceCenter()).force('dagRadial', null).stop(),\n      engineRunning: false\n    };\n  },\n  init: function init(canvasCtx, state) {\n    // Main canvas object to manipulate\n    state.ctx = canvasCtx;\n  },\n  update: function update(state) {\n    state.engineRunning = false; // Pause simulation\n\n    state.onUpdate();\n\n    if (state.nodeAutoColorBy !== null) {\n      // Auto add color to uncolored nodes\n      autoColorObjects(state.graphData.nodes, accessorFn(state.nodeAutoColorBy), state.nodeColor);\n    }\n\n    if (state.linkAutoColorBy !== null) {\n      // Auto add color to uncolored links\n      autoColorObjects(state.graphData.links, accessorFn(state.linkAutoColorBy), state.linkColor);\n    } // parse links\n\n\n    state.graphData.links.forEach(function (link) {\n      link.source = link[state.linkSource];\n      link.target = link[state.linkTarget];\n    });\n\n    if (!state.isShadow) {\n      // Add photon particles\n      var linkParticlesAccessor = accessorFn(state.linkDirectionalParticles);\n      state.graphData.links.forEach(function (link) {\n        var numPhotons = Math.round(Math.abs(linkParticlesAccessor(link)));\n\n        if (numPhotons) {\n          link.__photons = _toConsumableArray(Array(numPhotons)).map(function () {\n            return {};\n          });\n        } else {\n          delete link.__photons;\n        }\n      });\n    } // Feed data to force-directed layout\n\n\n    state.forceLayout.stop().alpha(1) // re-heat the simulation\n    .nodes(state.graphData.nodes); // add links (if link force is still active)\n\n    var linkForce = state.forceLayout.force('link');\n\n    if (linkForce) {\n      linkForce.id(function (d) {\n        return d[state.nodeId];\n      }).links(state.graphData.links);\n    } // setup dag force constraints\n\n\n    var nodeDepths = state.dagMode && getDagDepths(state.graphData, function (node) {\n      return node[state.nodeId];\n    }, {\n      nodeFilter: state.dagNodeFilter,\n      onLoopError: state.onDagError || undefined\n    });\n    var maxDepth = Math.max.apply(Math, _toConsumableArray(Object.values(nodeDepths || [])));\n    var dagLevelDistance = state.dagLevelDistance || state.graphData.nodes.length / (maxDepth || 1) * DAG_LEVEL_NODE_RATIO * (['radialin', 'radialout'].indexOf(state.dagMode) !== -1 ? 0.7 : 1); // Fix nodes to x,y for dag mode\n\n    if (state.dagMode) {\n      var getFFn = function getFFn(fix, invert) {\n        return function (node) {\n          return !fix ? undefined : (nodeDepths[node[state.nodeId]] - maxDepth / 2) * dagLevelDistance * (invert ? -1 : 1);\n        };\n      };\n\n      var fxFn = getFFn(['lr', 'rl'].indexOf(state.dagMode) !== -1, state.dagMode === 'rl');\n      var fyFn = getFFn(['td', 'bu'].indexOf(state.dagMode) !== -1, state.dagMode === 'bu');\n      state.graphData.nodes.filter(state.dagNodeFilter).forEach(function (node) {\n        node.fx = fxFn(node);\n        node.fy = fyFn(node);\n      });\n    } // Use radial force for radial dags\n\n\n    state.forceLayout.force('dagRadial', ['radialin', 'radialout'].indexOf(state.dagMode) !== -1 ? forceRadial(function (node) {\n      var nodeDepth = nodeDepths[node[state.nodeId]] || -1;\n      return (state.dagMode === 'radialin' ? maxDepth - nodeDepth : nodeDepth) * dagLevelDistance;\n    }).strength(function (node) {\n      return state.dagNodeFilter(node) ? 1 : 0;\n    }) : null);\n\n    for (var i = 0; i < state.warmupTicks && !(state.d3AlphaMin > 0 && state.forceLayout.alpha() < state.d3AlphaMin); i++) {\n      state.forceLayout.tick();\n    } // Initial ticks before starting to render\n\n\n    this.resetCountdown();\n    state.onFinishUpdate();\n  }\n});\n\nfunction linkKapsule (kapsulePropNames, kapsuleType) {\n  var propNames = kapsulePropNames instanceof Array ? kapsulePropNames : [kapsulePropNames];\n  var dummyK = new kapsuleType(); // To extract defaults\n\n  return {\n    linkProp: function linkProp(prop) {\n      // link property config\n      return {\n        \"default\": dummyK[prop](),\n        onChange: function onChange(v, state) {\n          propNames.forEach(function (propName) {\n            return state[propName][prop](v);\n          });\n        },\n        triggerUpdate: false\n      };\n    },\n    linkMethod: function linkMethod(method) {\n      // link method pass-through\n      return function (state) {\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        var returnVals = [];\n        propNames.forEach(function (propName) {\n          var kapsuleInstance = state[propName];\n          var returnVal = kapsuleInstance[method].apply(kapsuleInstance, args);\n\n          if (returnVal !== kapsuleInstance) {\n            returnVals.push(returnVal);\n          }\n        });\n        return returnVals.length ? returnVals[0] : this; // chain based on the parent object, not the inner kapsule\n      };\n    }\n  };\n}\n\nvar HOVER_CANVAS_THROTTLE_DELAY = 800; // ms to throttle shadow canvas updates for perf improvement\n\nvar ZOOM2NODES_FACTOR = 4; // Expose config from forceGraph\n\nvar bindFG = linkKapsule('forceGraph', CanvasForceGraph);\nvar bindBoth = linkKapsule(['forceGraph', 'shadowGraph'], CanvasForceGraph);\nvar linkedProps = Object.assign.apply(Object, _toConsumableArray(['nodeColor', 'nodeAutoColorBy', 'nodeCanvasObject', 'nodeCanvasObjectMode', 'linkColor', 'linkAutoColorBy', 'linkLineDash', 'linkWidth', 'linkCanvasObject', 'linkCanvasObjectMode', 'linkDirectionalArrowLength', 'linkDirectionalArrowColor', 'linkDirectionalArrowRelPos', 'linkDirectionalParticles', 'linkDirectionalParticleSpeed', 'linkDirectionalParticleWidth', 'linkDirectionalParticleColor', 'dagMode', 'dagLevelDistance', 'dagNodeFilter', 'onDagError', 'd3AlphaMin', 'd3AlphaDecay', 'd3VelocityDecay', 'warmupTicks', 'cooldownTicks', 'cooldownTime', 'onEngineTick', 'onEngineStop'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkProp(p));\n})).concat(_toConsumableArray(['nodeRelSize', 'nodeId', 'nodeVal', 'nodeVisibility', 'linkSource', 'linkTarget', 'linkVisibility', 'linkCurvature'].map(function (p) {\n  return _defineProperty({}, p, bindBoth.linkProp(p));\n}))));\nvar linkedMethods = Object.assign.apply(Object, _toConsumableArray(['d3Force', 'd3ReheatSimulation', 'emitParticle'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkMethod(p));\n})));\n\nfunction adjustCanvasSize(state) {\n  if (state.canvas) {\n    var curWidth = state.canvas.width;\n    var curHeight = state.canvas.height;\n\n    if (curWidth === 300 && curHeight === 150) {\n      // Default canvas dimensions\n      curWidth = curHeight = 0;\n    }\n\n    var pxScale = window.devicePixelRatio; // 2 on retina displays\n\n    curWidth /= pxScale;\n    curHeight /= pxScale; // Resize canvases\n\n    [state.canvas, state.shadowCanvas].forEach(function (canvas) {\n      // Element size\n      canvas.style.width = \"\".concat(state.width, \"px\");\n      canvas.style.height = \"\".concat(state.height, \"px\"); // Memory size (scaled to avoid blurriness)\n\n      canvas.width = state.width * pxScale;\n      canvas.height = state.height * pxScale; // Normalize coordinate system to use css pixels (on init only)\n\n      if (!curWidth && !curHeight) {\n        canvas.getContext('2d').scale(pxScale, pxScale);\n      }\n    }); // Relative center panning based on 0,0\n\n    var k = zoomTransform(state.canvas).k;\n    state.zoom.translateBy(state.zoom.__baseElem, (state.width - curWidth) / 2 / k, (state.height - curHeight) / 2 / k);\n    state.needsRedraw = true;\n  }\n}\n\nfunction resetTransform(ctx) {\n  var pxRatio = window.devicePixelRatio;\n  ctx.setTransform(pxRatio, 0, 0, pxRatio, 0, 0);\n}\n\nfunction clearCanvas(ctx, width, height) {\n  ctx.save();\n  resetTransform(ctx); // reset transform\n\n  ctx.clearRect(0, 0, width, height);\n  ctx.restore(); //restore transforms\n} //\n\n\nvar forceGraph = Kapsule({\n  props: _objectSpread2({\n    width: {\n      \"default\": window.innerWidth,\n      onChange: function onChange(_, state) {\n        return adjustCanvasSize(state);\n      },\n      triggerUpdate: false\n    },\n    height: {\n      \"default\": window.innerHeight,\n      onChange: function onChange(_, state) {\n        return adjustCanvasSize(state);\n      },\n      triggerUpdate: false\n    },\n    graphData: {\n      \"default\": {\n        nodes: [],\n        links: []\n      },\n      onChange: function onChange(d, state) {\n        [{\n          type: 'Node',\n          objs: d.nodes\n        }, {\n          type: 'Link',\n          objs: d.links\n        }].forEach(hexIndex);\n        state.forceGraph.graphData(d);\n        state.shadowGraph.graphData(d);\n\n        function hexIndex(_ref4) {\n          var type = _ref4.type,\n              objs = _ref4.objs;\n          objs.filter(function (d) {\n            if (!d.hasOwnProperty('__indexColor')) return true;\n            var cur = state.colorTracker.lookup(d.__indexColor);\n            return !cur || !cur.hasOwnProperty('d') || cur.d !== d;\n          }).forEach(function (d) {\n            // store object lookup color\n            d.__indexColor = state.colorTracker.register({\n              type: type,\n              d: d\n            });\n          });\n        }\n      },\n      triggerUpdate: false\n    },\n    backgroundColor: {\n      onChange: function onChange(color, state) {\n        state.canvas && color && (state.canvas.style.background = color);\n      },\n      triggerUpdate: false\n    },\n    nodeLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    nodePointerAreaPaint: {\n      onChange: function onChange(paintFn, state) {\n        state.shadowGraph.nodeCanvasObject(!paintFn ? null : function (node, ctx, globalScale) {\n          return paintFn(node, node.__indexColor, ctx, globalScale);\n        });\n        state.flushShadowCanvas && state.flushShadowCanvas();\n      },\n      triggerUpdate: false\n    },\n    linkPointerAreaPaint: {\n      onChange: function onChange(paintFn, state) {\n        state.shadowGraph.linkCanvasObject(!paintFn ? null : function (link, ctx, globalScale) {\n          return paintFn(link, link.__indexColor, ctx, globalScale);\n        });\n        state.flushShadowCanvas && state.flushShadowCanvas();\n      },\n      triggerUpdate: false\n    },\n    linkLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    linkHoverPrecision: {\n      \"default\": 4,\n      triggerUpdate: false\n    },\n    minZoom: {\n      \"default\": 0.01,\n      onChange: function onChange(minZoom, state) {\n        state.zoom.scaleExtent([minZoom, state.zoom.scaleExtent()[1]]);\n      },\n      triggerUpdate: false\n    },\n    maxZoom: {\n      \"default\": 1000,\n      onChange: function onChange(maxZoom, state) {\n        state.zoom.scaleExtent([state.zoom.scaleExtent()[0], maxZoom]);\n      },\n      triggerUpdate: false\n    },\n    enableNodeDrag: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    enableZoomInteraction: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    enablePanInteraction: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    enableZoomPanInteraction: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    // to be deprecated\n    enablePointerInteraction: {\n      \"default\": true,\n      onChange: function onChange(_, state) {\n        state.hoverObj = null;\n      },\n      triggerUpdate: false\n    },\n    autoPauseRedraw: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    onNodeDrag: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeDragEnd: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeClick: {\n      triggerUpdate: false\n    },\n    onNodeRightClick: {\n      triggerUpdate: false\n    },\n    onNodeHover: {\n      triggerUpdate: false\n    },\n    onLinkClick: {\n      triggerUpdate: false\n    },\n    onLinkRightClick: {\n      triggerUpdate: false\n    },\n    onLinkHover: {\n      triggerUpdate: false\n    },\n    onBackgroundClick: {\n      triggerUpdate: false\n    },\n    onBackgroundRightClick: {\n      triggerUpdate: false\n    },\n    onZoom: {\n      triggerUpdate: false\n    },\n    onZoomEnd: {\n      triggerUpdate: false\n    },\n    onRenderFramePre: {\n      triggerUpdate: false\n    },\n    onRenderFramePost: {\n      triggerUpdate: false\n    }\n  }, linkedProps),\n  aliases: {\n    // Prop names supported for backwards compatibility\n    stopAnimation: 'pauseAnimation'\n  },\n  methods: _objectSpread2({\n    graph2ScreenCoords: function graph2ScreenCoords(state, x, y) {\n      var t = zoomTransform(state.canvas);\n      return {\n        x: x * t.k + t.x,\n        y: y * t.k + t.y\n      };\n    },\n    screen2GraphCoords: function screen2GraphCoords(state, x, y) {\n      var t = zoomTransform(state.canvas);\n      return {\n        x: (x - t.x) / t.k,\n        y: (y - t.y) / t.k\n      };\n    },\n    centerAt: function centerAt(state, x, y, transitionDuration) {\n      if (!state.canvas) return null; // no canvas yet\n      // setter\n\n      if (x !== undefined || y !== undefined) {\n        var finalPos = Object.assign({}, x !== undefined ? {\n          x: x\n        } : {}, y !== undefined ? {\n          y: y\n        } : {});\n\n        if (!transitionDuration) {\n          // no animation\n          setCenter(finalPos);\n        } else {\n          new TWEEN.Tween(getCenter()).to(finalPos, transitionDuration).easing(TWEEN.Easing.Quadratic.Out).onUpdate(setCenter).start();\n        }\n\n        return this;\n      } // getter\n\n\n      return getCenter(); //\n\n      function getCenter() {\n        var t = zoomTransform(state.canvas);\n        return {\n          x: (state.width / 2 - t.x) / t.k,\n          y: (state.height / 2 - t.y) / t.k\n        };\n      }\n\n      function setCenter(_ref5) {\n        var x = _ref5.x,\n            y = _ref5.y;\n        state.zoom.translateTo(state.zoom.__baseElem, x === undefined ? getCenter().x : x, y === undefined ? getCenter().y : y);\n        state.needsRedraw = true;\n      }\n    },\n    zoom: function zoom(state, k, transitionDuration) {\n      if (!state.canvas) return null; // no canvas yet\n      // setter\n\n      if (k !== undefined) {\n        if (!transitionDuration) {\n          // no animation\n          setZoom(k);\n        } else {\n          new TWEEN.Tween({\n            k: getZoom()\n          }).to({\n            k: k\n          }, transitionDuration).easing(TWEEN.Easing.Quadratic.Out).onUpdate(function (_ref6) {\n            var k = _ref6.k;\n            return setZoom(k);\n          }).start();\n        }\n\n        return this;\n      } // getter\n\n\n      return getZoom(); //\n\n      function getZoom() {\n        return zoomTransform(state.canvas).k;\n      }\n\n      function setZoom(k) {\n        state.zoom.scaleTo(state.zoom.__baseElem, k);\n        state.needsRedraw = true;\n      }\n    },\n    zoomToFit: function zoomToFit(state) {\n      var transitionDuration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var padding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 10;\n\n      for (var _len = arguments.length, bboxArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n        bboxArgs[_key - 3] = arguments[_key];\n      }\n\n      var bbox = this.getGraphBbox.apply(this, bboxArgs);\n\n      if (bbox) {\n        var center = {\n          x: (bbox.x[0] + bbox.x[1]) / 2,\n          y: (bbox.y[0] + bbox.y[1]) / 2\n        };\n        var zoomK = Math.max(1e-12, Math.min(1e12, (state.width - padding * 2) / (bbox.x[1] - bbox.x[0]), (state.height - padding * 2) / (bbox.y[1] - bbox.y[0])));\n        this.centerAt(center.x, center.y, transitionDuration);\n        this.zoom(zoomK, transitionDuration);\n      }\n\n      return this;\n    },\n    getGraphBbox: function getGraphBbox(state) {\n      var nodeFilter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {\n        return true;\n      };\n      var getVal = accessorFn(state.nodeVal);\n\n      var getR = function getR(node) {\n        return Math.sqrt(Math.max(0, getVal(node) || 1)) * state.nodeRelSize;\n      };\n\n      var nodesPos = state.graphData.nodes.filter(nodeFilter).map(function (node) {\n        return {\n          x: node.x,\n          y: node.y,\n          r: getR(node)\n        };\n      });\n      return !nodesPos.length ? null : {\n        x: [min(nodesPos, function (node) {\n          return node.x - node.r;\n        }), max(nodesPos, function (node) {\n          return node.x + node.r;\n        })],\n        y: [min(nodesPos, function (node) {\n          return node.y - node.r;\n        }), max(nodesPos, function (node) {\n          return node.y + node.r;\n        })]\n      };\n    },\n    pauseAnimation: function pauseAnimation(state) {\n      if (state.animationFrameRequestId) {\n        cancelAnimationFrame(state.animationFrameRequestId);\n        state.animationFrameRequestId = null;\n      }\n\n      return this;\n    },\n    resumeAnimation: function resumeAnimation(state) {\n      if (!state.animationFrameRequestId) {\n        this._animationCycle();\n      }\n\n      return this;\n    },\n    _destructor: function _destructor() {\n      this.pauseAnimation();\n      this.graphData({\n        nodes: [],\n        links: []\n      });\n    }\n  }, linkedMethods),\n  stateInit: function stateInit() {\n    return {\n      lastSetZoom: 1,\n      zoom: zoom(),\n      forceGraph: new CanvasForceGraph(),\n      shadowGraph: new CanvasForceGraph().cooldownTicks(0).nodeColor('__indexColor').linkColor('__indexColor').isShadow(true),\n      colorTracker: new ColorTracker() // indexed objects for rgb lookup\n\n    };\n  },\n  init: function init(domNode, state) {\n    var _this = this;\n\n    // Wipe DOM\n    domNode.innerHTML = ''; // Container anchor for canvas and tooltip\n\n    var container = document.createElement('div');\n    container.classList.add('force-graph-container');\n    container.style.position = 'relative';\n    domNode.appendChild(container);\n    state.canvas = document.createElement('canvas');\n    if (state.backgroundColor) state.canvas.style.background = state.backgroundColor;\n    container.appendChild(state.canvas);\n    state.shadowCanvas = document.createElement('canvas'); // Show shadow canvas\n    //state.shadowCanvas.style.position = 'absolute';\n    //state.shadowCanvas.style.top = '0';\n    //state.shadowCanvas.style.left = '0';\n    //container.appendChild(state.shadowCanvas);\n\n    var ctx = state.canvas.getContext('2d');\n    var shadowCtx = state.shadowCanvas.getContext('2d');\n    var pointerPos = {\n      x: -1e12,\n      y: -1e12\n    };\n\n    var getObjUnderPointer = function getObjUnderPointer() {\n      var obj = null;\n      var pxScale = window.devicePixelRatio;\n      var px = pointerPos.x > 0 && pointerPos.y > 0 ? shadowCtx.getImageData(pointerPos.x * pxScale, pointerPos.y * pxScale, 1, 1) : null; // Lookup object per pixel color\n\n      px && (obj = state.colorTracker.lookup(px.data));\n      return obj;\n    }; // Setup node drag interaction\n\n\n    select(state.canvas).call(drag().subject(function () {\n      if (!state.enableNodeDrag) {\n        return null;\n      }\n\n      var obj = getObjUnderPointer();\n      return obj && obj.type === 'Node' ? obj.d : null; // Only drag nodes\n    }).on('start', function (ev) {\n      var obj = ev.subject;\n      obj.__initialDragPos = {\n        x: obj.x,\n        y: obj.y,\n        fx: obj.fx,\n        fy: obj.fy\n      }; // keep engine running at low intensity throughout drag\n\n      if (!ev.active) {\n        obj.fx = obj.x;\n        obj.fy = obj.y; // Fix points\n      } // drag cursor\n\n\n      state.canvas.classList.add('grabbable');\n    }).on('drag', function (ev) {\n      var obj = ev.subject;\n      var initPos = obj.__initialDragPos;\n      var dragPos = ev;\n      var k = zoomTransform(state.canvas).k;\n      var translate = {\n        x: initPos.x + (dragPos.x - initPos.x) / k - obj.x,\n        y: initPos.y + (dragPos.y - initPos.y) / k - obj.y\n      }; // Move fx/fy (and x/y) of nodes based on the scaled drag distance since the drag start\n\n      ['x', 'y'].forEach(function (c) {\n        return obj[\"f\".concat(c)] = obj[c] = initPos[c] + (dragPos[c] - initPos[c]) / k;\n      }); // prevent freeze while dragging\n\n      state.forceGraph.d3AlphaTarget(0.3) // keep engine running at low intensity throughout drag\n      .resetCountdown(); // prevent freeze while dragging\n\n      state.isPointerDragging = true;\n      obj.__dragged = true;\n      state.onNodeDrag(obj, translate);\n    }).on('end', function (ev) {\n      var obj = ev.subject;\n      var initPos = obj.__initialDragPos;\n      var translate = {\n        x: obj.x - initPos.x,\n        y: obj.y - initPos.y\n      };\n\n      if (initPos.fx === undefined) {\n        obj.fx = undefined;\n      }\n\n      if (initPos.fy === undefined) {\n        obj.fy = undefined;\n      }\n\n      delete obj.__initialDragPos;\n\n      if (state.forceGraph.d3AlphaTarget()) {\n        state.forceGraph.d3AlphaTarget(0) // release engine low intensity\n        .resetCountdown(); // let the engine readjust after releasing fixed nodes\n      } // drag cursor\n\n\n      state.canvas.classList.remove('grabbable');\n      state.isPointerDragging = false;\n\n      if (obj.__dragged) {\n        delete obj.__dragged;\n        state.onNodeDragEnd(obj, translate);\n      }\n    })); // Setup zoom / pan interaction\n\n    state.zoom(state.zoom.__baseElem = select(state.canvas)); // Attach controlling elem for easy access\n\n    state.zoom.__baseElem.on('dblclick.zoom', null); // Disable double-click to zoom\n\n\n    state.zoom.filter(function (ev) {\n      return (// disable zoom interaction\n        !ev.button && state.enableZoomPanInteraction && (state.enableZoomInteraction || ev.type !== 'wheel') && (state.enablePanInteraction || ev.type === 'wheel')\n      );\n    }).on('zoom', function (ev) {\n      var t = ev.transform;\n      [ctx, shadowCtx].forEach(function (c) {\n        resetTransform(c);\n        c.translate(t.x, t.y);\n        c.scale(t.k, t.k);\n      });\n      state.onZoom && state.onZoom(_objectSpread2(_objectSpread2({}, t), _this.centerAt())); // report x,y coordinates relative to canvas center\n\n      state.needsRedraw = true;\n    }).on('end', function (ev) {\n      return state.onZoomEnd && state.onZoomEnd(_objectSpread2(_objectSpread2({}, ev.transform), _this.centerAt()));\n    });\n    adjustCanvasSize(state);\n    state.forceGraph.onNeedsRedraw(function () {\n      return state.needsRedraw = true;\n    }).onFinishUpdate(function () {\n      // re-zoom, if still in default position (not user modified)\n      if (zoomTransform(state.canvas).k === state.lastSetZoom && state.graphData.nodes.length) {\n        state.zoom.scaleTo(state.zoom.__baseElem, state.lastSetZoom = ZOOM2NODES_FACTOR / Math.cbrt(state.graphData.nodes.length));\n        state.needsRedraw = true;\n      }\n    }); // Setup tooltip\n\n    var toolTipElem = document.createElement('div');\n    toolTipElem.classList.add('graph-tooltip');\n    container.appendChild(toolTipElem); // Capture pointer coords on move or touchstart\n\n    ['pointermove', 'pointerdown'].forEach(function (evType) {\n      return container.addEventListener(evType, function (ev) {\n        if (evType === 'pointerdown') {\n          state.isPointerPressed = true; // track click state\n\n          state.pointerDownEvent = ev;\n        } // detect pointer drag on canvas pan\n\n\n        !state.isPointerDragging && ev.type === 'pointermove' && state.onBackgroundClick // only bother detecting drags this way if background clicks are enabled (so they don't trigger accidentally on canvas panning)\n        && (ev.pressure > 0 || state.isPointerPressed) // ev.pressure always 0 on Safari, so we use the isPointerPressed tracker\n        && (ev.pointerType !== 'touch' || ev.movementX === undefined || [ev.movementX, ev.movementY].some(function (m) {\n          return Math.abs(m) > 1;\n        })) // relax drag trigger sensitivity on touch events\n        && (state.isPointerDragging = true); // update the pointer pos\n\n        var offset = getOffset(container);\n        pointerPos.x = ev.pageX - offset.left;\n        pointerPos.y = ev.pageY - offset.top; // Move tooltip\n\n        toolTipElem.style.top = \"\".concat(pointerPos.y, \"px\");\n        toolTipElem.style.left = \"\".concat(pointerPos.x, \"px\"); //\n\n        function getOffset(el) {\n          var rect = el.getBoundingClientRect(),\n              scrollLeft = window.pageXOffset || document.documentElement.scrollLeft,\n              scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n          return {\n            top: rect.top + scrollTop,\n            left: rect.left + scrollLeft\n          };\n        }\n      }, {\n        passive: true\n      });\n    }); // Handle click/touch events on nodes/links\n\n    container.addEventListener('pointerup', function (ev) {\n      state.isPointerPressed = false;\n\n      if (state.isPointerDragging) {\n        state.isPointerDragging = false;\n        return; // don't trigger click events after pointer drag (pan / node drag functionality)\n      }\n\n      var cbEvents = [ev, state.pointerDownEvent];\n      requestAnimationFrame(function () {\n        // trigger click events asynchronously, to allow hoverObj to be set (on frame)\n        if (ev.button === 0) {\n          // mouse left-click or touch\n          if (state.hoverObj) {\n            var fn = state[\"on\".concat(state.hoverObj.type, \"Click\")];\n            fn && fn.apply(void 0, [state.hoverObj.d].concat(cbEvents));\n          } else {\n            state.onBackgroundClick && state.onBackgroundClick.apply(state, cbEvents);\n          }\n        }\n\n        if (ev.button === 2) {\n          // mouse right-click\n          if (state.hoverObj) {\n            var _fn = state[\"on\".concat(state.hoverObj.type, \"RightClick\")];\n            _fn && _fn.apply(void 0, [state.hoverObj.d].concat(cbEvents));\n          } else {\n            state.onBackgroundRightClick && state.onBackgroundRightClick.apply(state, cbEvents);\n          }\n        }\n      });\n    }, {\n      passive: true\n    });\n    container.addEventListener('contextmenu', function (ev) {\n      if (!state.onBackgroundRightClick && !state.onNodeRightClick && !state.onLinkRightClick) return true; // default contextmenu behavior\n\n      ev.preventDefault();\n      return false;\n    });\n    state.forceGraph(ctx);\n    state.shadowGraph(shadowCtx); //\n\n    var refreshShadowCanvas = throttle(function () {\n      // wipe canvas\n      clearCanvas(shadowCtx, state.width, state.height); // Adjust link hover area\n\n      state.shadowGraph.linkWidth(function (l) {\n        return accessorFn(state.linkWidth)(l) + state.linkHoverPrecision;\n      }); // redraw\n\n      var t = zoomTransform(state.canvas);\n      state.shadowGraph.globalScale(t.k).tickFrame();\n    }, HOVER_CANVAS_THROTTLE_DELAY);\n    state.flushShadowCanvas = refreshShadowCanvas.flush; // hook to immediately invoke shadow canvas paint\n    // Kick-off renderer\n\n    (this._animationCycle = function animate() {\n      // IIFE\n      var doRedraw = !state.autoPauseRedraw || !!state.needsRedraw || state.forceGraph.isEngineRunning() || state.graphData.links.some(function (d) {\n        return d.__photons && d.__photons.length;\n      });\n      state.needsRedraw = false;\n\n      if (state.enablePointerInteraction) {\n        // Update tooltip and trigger onHover events\n        var obj = !state.isPointerDragging ? getObjUnderPointer() : null; // don't hover during drag\n\n        if (obj !== state.hoverObj) {\n          var prevObj = state.hoverObj;\n          var prevObjType = prevObj ? prevObj.type : null;\n          var objType = obj ? obj.type : null;\n\n          if (prevObjType && prevObjType !== objType) {\n            // Hover out\n            var fn = state[\"on\".concat(prevObjType, \"Hover\")];\n            fn && fn(null, prevObj.d);\n          }\n\n          if (objType) {\n            // Hover in\n            var _fn2 = state[\"on\".concat(objType, \"Hover\")];\n            _fn2 && _fn2(obj.d, prevObjType === objType ? prevObj.d : null);\n          }\n\n          var tooltipContent = obj ? accessorFn(state[\"\".concat(obj.type.toLowerCase(), \"Label\")])(obj.d) || '' : '';\n          toolTipElem.style.visibility = tooltipContent ? 'visible' : 'hidden';\n          toolTipElem.innerHTML = tooltipContent; // set pointer if hovered object is clickable\n\n          state.canvas.classList[obj && state[\"on\".concat(objType, \"Click\")] || !obj && state.onBackgroundClick ? 'add' : 'remove']('clickable');\n          state.hoverObj = obj;\n        }\n\n        doRedraw && refreshShadowCanvas();\n      }\n\n      if (doRedraw) {\n        // Wipe canvas\n        clearCanvas(ctx, state.width, state.height); // Frame cycle\n\n        var globalScale = zoomTransform(state.canvas).k;\n        state.onRenderFramePre && state.onRenderFramePre(ctx, globalScale);\n        state.forceGraph.globalScale(globalScale).tickFrame();\n        state.onRenderFramePost && state.onRenderFramePost(ctx, globalScale);\n      }\n\n      TWEEN.update(); // update canvas animation tweens\n\n      state.animationFrameRequestId = requestAnimationFrame(animate);\n    })();\n  },\n  update: function updateFn(state) {}\n});\n\nexport { forceGraph as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}