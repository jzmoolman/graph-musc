{"ast":null,"code":"var _jsxFileName = \"/Users/zack/src/gene-graph-MUSC/src/components/BaseGrpah.tsx\",\n    _s = $RefreshSig$();\n\nimport { useState, useContext, useEffect, useRef } from 'react';\nimport { Neo4jContext } from 'use-neo4j';\nimport ForceGraph2D from 'react-force-graph-2d';\nimport { paintNode } from '../tools/graphtools';\nimport { loadGeneData, loadOrganData, loadSyndromeGeneData, loadSyndromeOrganData, loadSyndromeGeneOrganData } from '../tools/grapgdata';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst drawerWidth = 350;\nexport const BaseGraph = _ref => {\n  _s();\n\n  let {\n    drawerOpen,\n    name,\n    verified,\n    genes,\n    organs,\n    syndromes,\n    graphScheme\n  } = _ref;\n  console.log(`enter - ${name}Graph`);\n  const isMounted = useRef(false);\n  const [renderTick, setRenderTick] = useState(0);\n  const [nodefocused, setNodeFocus] = useState(false);\n\n  const handleResize = () => {\n    console.log('onResize');\n    console.log('renderTick', renderTick);\n    setRenderTick(renderTick => renderTick + 1);\n  };\n\n  const handleNodeHover = (node, previousNode) => {\n    console.log('node', node);\n    console.log('prevNode', node);\n  };\n\n  const handleNodeClick = (node, event) => {\n    console.log('node', node);\n    console.log('prevNode', node);\n  };\n\n  useEffect(() => {\n    console.log('Graph mounted');\n    isMounted.current = true;\n    window.addEventListener(\"resize\", handleResize);\n  }, []);\n  const context = useContext(Neo4jContext),\n        driver = context.driver;\n  const [data, setData] = useState({\n    nodes: [],\n    links: []\n  });\n  useEffect(() => {\n    console.log('Reload data');\n\n    const onData = data => {\n      console.log(data);\n      setData(data);\n    };\n\n    console.log('name', name);\n\n    if (name === 'gene') {\n      loadGeneData(driver, verified, genes, organs, graphScheme, onData);\n    } else if (name === 'organ') loadOrganData(driver, verified, genes, organs, graphScheme, onData);else if (name === 'syndrome-gene') {\n      loadSyndromeGeneData(driver, verified, syndromes, genes, graphScheme, onData);\n    } else if (name === 'syndrome-organ') {\n      loadSyndromeOrganData(driver, verified, syndromes, organs, graphScheme, onData);\n    } else if (name === 'syndrome-gene-organ') {\n      loadSyndromeGeneOrganData(driver, verified, syndromes, genes, organs, graphScheme, onData);\n    }\n  }, [name, verified, genes, organs, syndromes, graphScheme]);\n  const forceRef = useRef();\n  let Width = window.innerWidth - 18;\n\n  if (drawerOpen) {\n    Width = window.innerWidth - 18 - drawerWidth;\n  }\n\n  const Height = window.innerHeight - 85;\n\n  let handleEngineStop = () => {\n    if (forceRef.current) forceRef.current.zoomToFit(400);\n  };\n\n  if (!graphScheme.fitViewPort) {\n    if (forceRef.current) {}\n  }\n\n  return /*#__PURE__*/_jsxDEV(ForceGraph2D, {\n    ref: forceRef,\n    width: Width,\n    height: Height,\n    graphData: data,\n    backgroundColor: \"white\",\n    nodeId: \"name\",\n    nodeColor: \"nodeColor\",\n    nodeLabel: \"name\",\n    linkDirectionalArrowRelPos: 1,\n    linkDirectionalArrowLength: 2,\n    cooldownTicks: 100 // onEngineStop={ () => forceRef.current?.zoomToFit(100)} \n    ,\n    onEngineStop: handleEngineStop,\n    nodeVal: graphScheme.nodeVal,\n    nodeRelSize: graphScheme.nodeRelSize,\n    nodeCanvasObjectMode: () => 'after',\n    nodeCanvasObject: paintNode,\n    onNodeHover: handleNodeHover,\n    onNodeClick: handleNodeClick\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 9\n  }, this);\n};\n\n_s(BaseGraph, \"pkeh59x92m9WA+nH50gMdJCjoBY=\");\n\n_c = BaseGraph;\n\nvar _c;\n\n$RefreshReg$(_c, \"BaseGraph\");","map":{"version":3,"names":["useState","useContext","useEffect","useRef","Neo4jContext","ForceGraph2D","paintNode","loadGeneData","loadOrganData","loadSyndromeGeneData","loadSyndromeOrganData","loadSyndromeGeneOrganData","drawerWidth","BaseGraph","drawerOpen","name","verified","genes","organs","syndromes","graphScheme","console","log","isMounted","renderTick","setRenderTick","nodefocused","setNodeFocus","handleResize","handleNodeHover","node","previousNode","handleNodeClick","event","current","window","addEventListener","context","driver","data","setData","nodes","links","onData","forceRef","Width","innerWidth","Height","innerHeight","handleEngineStop","zoomToFit","fitViewPort","nodeVal","nodeRelSize"],"sources":["/Users/zack/src/gene-graph-MUSC/src/components/BaseGrpah.tsx"],"sourcesContent":["\nimport { useState, useContext, useEffect, useRef, MutableRefObject } from 'react'\nimport { Driver }  from  'neo4j-driver'\nimport { Neo4jContext } from 'use-neo4j'\nimport ForceGraph2D, { ForceGraphMethods, NodeObject }  from 'react-force-graph-2d'\nimport { Force2DData, GraphScheme, paintNode } from '../tools/graphtools'\nimport { \n    loadGeneData,\n    loadOrganData,\n    loadSyndromeGeneData,\n    loadSyndromeOrganData,\n    loadSyndromeGeneOrganData\n } from '../tools/grapgdata'\n\nconst drawerWidth = 350;\n\ntype BaseGraphProps = {\n    drawerOpen: boolean\n    name: string\n    verified: boolean\n    genes: string[]\n    organs: string[]\n    syndromes: string[]\n    graphScheme: GraphScheme\n}\nexport const BaseGraph = ( {drawerOpen, name, verified, genes, organs,syndromes, graphScheme} : BaseGraphProps ) => {\n\n    console.log(`enter - ${name}Graph`)\n    \n    const isMounted = useRef(false)\n    const [renderTick, setRenderTick] = useState(0);\n    const [nodefocused, setNodeFocus ] = useState(false)\n\n    const handleResize = () => {\n        console.log('onResize')\n        console.log('renderTick', renderTick )\n        setRenderTick(renderTick => renderTick + 1 )\n    }\n\n    const handleNodeHover = (node: NodeObject, previousNode: NodeObject ) => {\n        console.log('node', node)\n        console.log('prevNode', node)\n    }\n\n    const handleNodeClick = (node: NodeObject, event: MouseEvent  ) => {\n        console.log('node', node)\n        console.log('prevNode', node)\n    }\n    useEffect(()=>{\n        console.log('Graph mounted')\n        isMounted.current = true\n        window.addEventListener(\"resize\", handleResize )\n    },[])\n\n    const context = useContext(Neo4jContext), driver = context.driver\n    const [data, setData] =  useState<Force2DData>( {nodes: [], links: []} )\n\n    useEffect( () => {\n        console.log('Reload data')\n        const onData = (data: Force2DData) =>{\n            console.log(data)\n            setData(data)\n        }\n        console.log('name',name)\n\n        if (name === 'gene') {\n          loadGeneData(driver, verified, genes, organs, graphScheme, onData)\n        } else if (name === 'organ')\n          loadOrganData(driver, verified, genes, organs, graphScheme, onData)\n        else if ( name === 'syndrome-gene') {\n          loadSyndromeGeneData(driver, verified,  syndromes, genes, graphScheme, onData)\n        } else if ( name === 'syndrome-organ') {\n          loadSyndromeOrganData(driver, verified,  syndromes, organs, graphScheme, onData)\n        } else if ( name === 'syndrome-gene-organ') {\n          loadSyndromeGeneOrganData(driver, verified,  syndromes, genes, organs, graphScheme, onData)\n        }\n\n    },[ name, verified, genes, organs,syndromes, graphScheme] )\n    \n    const forceRef : MutableRefObject<ForceGraphMethods | undefined> = useRef()      \n\n    let Width = window.innerWidth -18\n    if (drawerOpen) {\n        Width = window.innerWidth -18 - drawerWidth\n    }\n    const Height = window.innerHeight -85\n    let handleEngineStop: ()=>void | undefined = () => {\n        if (forceRef.current)\n            (forceRef.current as ForceGraphMethods).zoomToFit(400) \n    }\n    \n    if (!graphScheme.fitViewPort) {\n        if (forceRef.current) {}\n    }\n\n    return ( \n        <ForceGraph2D \n            ref={forceRef}\n            width={Width}\n            height={Height}\n            graphData={data}\n            backgroundColor='white'\n            nodeId='name'  \n            nodeColor='nodeColor' \n            nodeLabel='name' \n            linkDirectionalArrowRelPos={1} \n            linkDirectionalArrowLength={2} \n            cooldownTicks={100}\n            // onEngineStop={ () => forceRef.current?.zoomToFit(100)} \n            onEngineStop={handleEngineStop} \n            nodeVal={graphScheme.nodeVal}\n            nodeRelSize={graphScheme.nodeRelSize}\n            nodeCanvasObjectMode={() => 'after'} \n            nodeCanvasObject={paintNode}\n            onNodeHover={handleNodeHover}\n            onNodeClick={handleNodeClick}\n            />\n    )\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}