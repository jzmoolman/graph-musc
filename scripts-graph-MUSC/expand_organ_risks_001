MATCH (g:MGene)-[l:AFFECTS]->(o:Organ)
MATCH (r:LKP_MASTER_RISKTO85FORGRAPH)
WHERE r.gene = g.name
AND r.cancer = o.name
WITH g, o,l, collect(r.gender) AS gender, collect(r.maxofcr85) AS risk
SET l.male_risk = risk[0],
    l.female_risk = risk[1]



MATCH (g:MGene)--(o:Organ)
MATCH (n:LKP_MASTER_RISKTO85FORGRAPH)
WHERE n.gene = g.name
AND n.organ = o.name
WITH g, o, collect(n.gender) as gender, collect(n.maxofcr85) as risk
SET o.male_risk = risk[0],
    o.female_risk = risk[1]


MATCH (g:MGene)--(o:Organ)
MATCH (n:LKP_MASTER_RISKTO85FORGRAPH)
WHERE n.gene = g.name
AND n.organ = o.name  
CALL {
  WITH o
  MATCH (t:LKP_MASTER_RISKTO85FORGRAPH)
  WHERE t.gene = 'Population' 
  AND t.organ = o.name
  AND t.gender ='Male'
  RETURN t.maxofcr85 as male_population_risk
}
CALL {
  WITH o 
  MATCH (t:LKP_MASTER_RISKTO85FORGRAPH)
  WHERE t.gene = 'Population' 
  AND t.organ = o.name
  AND t.gender ='Female'
  RETURN t.maxofcr85 as female_population_risk
}

WITH g, o, collect(n.gender) as gender, 
collect(n.maxofcr85) as risk,
male_population_risk, female_population_risk

SET o.male_risk = risk[0],  
    o.female_risk = risk[1],
    o.male_population_risk = male_population_risk,
    o.female_population_risk = female_population_risk


    MATCH (g:MGene)--(o:Organ)
CALL { 
  WITH  o
  MATCH (n:LKP_MASTER_RISKTO85FORGRAPH)
  WHERE n.gene = 'Population'  
   AND n.organ = o.name
   AND n.gender = 'Male'
  RETURN n
}
// RETURN g.name, o.name, n.maxofcr85
SET 
    o.male_population_risk = n.maxofcr85;

MATCH (g:MGene)--(o:Organ)
CALL { 
  WITH  o
  MATCH (n:LKP_MASTER_RISKTO85FORGRAPH)
  WHERE n.gene = 'Population'  
   AND n.organ = o.name
   AND n.gender = 'Female'
  RETURN n
}
// RETURN g.name, o.name, n.maxofcr85
SET 
    o.female_population_risk = n.maxofcr85;